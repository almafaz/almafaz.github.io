<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Code</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link
    href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
    rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="assets/vendor/remixicon/remixicon.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="assets/css/style.css" rel="stylesheet">

  <link href="assets/css/jupyter_notebook.css" rel="stylesheet">

  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&family=Poppins:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,600;0,700;1,300;1,400;1,600;1,700&display=swap"
    rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/aos/aos.css" rel="stylesheet">
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

  <!-- Variables CSS Files. Uncomment your preferred color scheme -->
  <link href="assets/css/variables.css" rel="stylesheet">
  <!-- <link href="assets/css/variables-blue.css" rel="stylesheet"> -->
  <!-- <link href="assets/css/variables-green.css" rel="stylesheet"> -->
  <!-- <link href="assets/css/variables-orange.css" rel="stylesheet"> -->
  <!-- <link href="assets/css/variables-purple.css" rel="stylesheet"> -->
  <!-- <link href="assets/css/variables-red.css" rel="stylesheet"> -->
  <!-- <link href="assets/css/variables-pink.css" rel="stylesheet"> -->

  <!-- Template Main CSS File -->
  <link href="assets/css/main.css" rel="stylesheet">

  <!-- =======================================================
* Template Name: HeroBiz - v2.1.0
* Template URL: https://bootstrapmade.com/herobiz-bootstrap-business-template/
* Author: BootstrapMade.com
* License: https://bootstrapmade.com/license/
======================================================== -->
</head>

<body>

  <!-- ======= Header ======= -->
  <header id="header" class="header fixed-top" data-scrollto-offset="0">
    <div class="container-fluid d-flex align-items-center justify-content-between">

      <nav id="navbar" class="navbar">
        <ul>
          <li><a class="nav-link scrollto" href="index.html#hero">Home</a></li>
          <li><a class="nav-link scrollto" href="time_analysis.html">Analysis by Time</a></li>
          <li><a href="language_analysis.html">Analysis by Language</a></li>
          <li class="dropdown megamenu"><a href="#"><span>Data Visualisation Quick Links</span> <i
                class="bi bi-chevron-down dropdown-indicator"></i></a>
            <ul>
              <li>
                <a href="index.html#tweet_volume">Tweet Volume</a>
              </li>
              <li>
                <a href="time_analysis.html#bar_chart">Hashtags Evolution</a>
                <a href="time_analysis.html#lexical">Dispersion of Words over Time</a>
              </li>
              <li>
                <a href="language_analysis.html#social_networks">Social Network by Language</a>
                <a href="ukranian_network_graph.html" target="blank_">Interactive Ukranian Network</a>
                <a href="russian_network_graph.html" target="blank_">Interactive Russian Network</a>
              </li>
              <li>
                <a href="time_analysis.html#wordclouds">Wordclouds by Time</a>
                <a href="time_analysis.html#wordshift">Wordshift by Time</a>
                <a href="language_analysis.html#wordclouds">Wordclouds by Language</a>
              </li>
            </ul>
          </li>
          <li><a class="nav-link scrollto" href="code.html" target="blank_">Explainer Notebook</a></li>
          <li><a href="test_data.csv" download="test_data.csv">Download Test Data</a></li>
        </ul>
        <i class="bi bi-list mobile-nav-toggle d-none"></i>
      </nav><!-- .navbar -->
    </div>
  </header><!-- End Header -->

  <section id="wordclouds_time" class="about">
    <div class="container" data-aos="fade-up">

      <div class="section-header">
        <h2>Our Code</h2>
        <p> write something about when the time periods are and stuff like that - write conclusion - what can we see
          when comparing all the wordclouds? is there anything interesting?</p>
      </div>

    </div>

  </section>


  <!-- add mathjax code here -->
  
  <!-- Load mathjax -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-MML-AM_CHTML-full,Safe">
  </script>
  <!-- MathJax configuration -->
  <script type="text/x-mathjax-config">
    init_mathjax = function() {
        if (window.MathJax) {
        // MathJax loaded
            MathJax.Hub.Config({
                TeX: {
                    equationNumbers: {
                    autoNumber: "AMS",
                    useLabelIds: true
                    }
                },
                tex2jax: {
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                    processEscapes: true,
                    processEnvironments: true
                },
                displayAlign: 'center',
                CommonHTML: {
                    linebreaks: { 
                    automatic: true 
                    }
                },
                "HTML-CSS": {
                    linebreaks: { 
                    automatic: true 
                    }
                }
            });
        
            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        }
    }
    init_mathjax();
    </script>
  <!-- End of mathjax configuration -->
</head>

<body class="jp-Notebook" data-jp-theme-light="true" data-jp-theme-name="JupyterLab Light">

  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h4 id="Website:">Website:<a class="anchor-link" href="#Website:">&#182;</a></h4>
      <p><a href="https://almafaz.github.io/index.html#hero">https://almafaz.github.io/index.html#hero</a></p>
      <h4 id="Github-Repository:">Github Repository:<a class="anchor-link" href="#Github-Repository:">&#182;</a></h4>
      <p><a href="https://github.com/almafaz/almafaz.github.io">https://github.com/almafaz/almafaz.github.io</a></p>
      <h4 id="Group-Contributions">Group Contributions<a class="anchor-link" href="#Group-Contributions">&#182;</a></h4>
      <p>Group members: Simone von Mehren (s190739), Natasha Norsker (s194270) and Alma Fazlagic (s194271)</p>
      <p>All group members contributed equally, but the main contributers on the sub-sections were:</p>
      <ul>
        <li><em>Data collection: Simone &amp; Alma</em></li>
        <li><em>Text cleaning: Natasha</em></li>
        <li><em>Text analysis and visualizations: Natasha &amp; Simone</em></li>
        <li><em>Network analysis: Alma</em></li>
        <li><em>Website: Natasha</em></li>
        <li><em>HPC: Simone</em></li>
        <li><em>Explainer notebook: All</em></li>
      </ul>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h1 id="Explainer-Notebook">Explainer Notebook<a class="anchor-link" href="#Explainer-Notebook">&#182;</a></h1>
    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h2 id="Motivation">Motivation<a class="anchor-link" href="#Motivation">&#182;</a></h2>
    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h4 id="The-Ukraine-Russia-tweet-data">The Ukraine-Russia tweet data<a class="anchor-link"
          href="#The-Ukraine-Russia-tweet-data">&#182;</a></h4>
      <p>In this project we worked with a huge dataset of tweets discussing the on-going war between Ukraine and Russia.
        The dataset building the foundation for this project was originally retrieved from the Github repo of <a
          href="https://github.com/ehsanulhaq1/russo_ukraine_dataset">ehsanulhaq1/russo_ukraine_dataset</a> and consists
        of tweet ids for all tweets containing certain key words relevant to the war in the period from 21st February
        2022 to 15th April 2022. Using the tweet ids, we were able to download the corresponding tweets from Twitter as
        well as a number of attributes including the user name, language, date of creation, etc. Twitter is used by 229
        million users daily <a
          href="https://www.aljazeera.com/economy/2022/4/28/twitter-daily-user-growth-rises-as-musk-readies-to-take-control">(www.aljazeera.com)</a>
        and is thereby an extensive source, if one wants insights about the public opinion of some matter. The original
        dataset collected by ehsanulhaq consists of 3 million+ tweets distributed over 54 days and we subsampled one
        million tweets for the analysis and data visualisations in this project.</p>
      <h4 id="Some-of-the-million-reasons-why-this-data-is-interesting">Some of the million reasons why this data is
        interesting<a class="anchor-link" href="#Some-of-the-million-reasons-why-this-data-is-interesting">&#182;</a>
      </h4>
      <p>The Russian invasion of Ukraine has shook many countries and has severely affected economies, families and
        political relationships across the world. As an effect of Russia's endless war crimes, threat to Ukraine's
        independence and strained relationship to NATO, many countries have imposed sanctions on Russia resulting in
        price increases and a massive decrease in delivery of gas from Russia to the world. More importantly, more than
        14.000 Ukranians have lost their lives and many more has become refugees in Europe.</p>
      <p>All of these reasons makes it interesting and highly relevant to analyse the public opinion and discourse
        towards Russia and the war in general - and Twitter is a great source to access this. We want to investigate
        whether there has been any change in the discourse and sentiment towards Ukraine and Russia during the period of
        the war, and whether there are any differences in the political and public opinion from one country to another.
      </p>
      <p>Furthermore, we will investigate the nature of how users interact in Ukrainian and Russian by doing a network
        analysis, where we look at both clustering trends and community detection.</p>
      <h4 id="What's-in-it-for-you?">What's in it for you?<a class="anchor-link"
          href="#What's-in-it-for-you?">&#182;</a></h4>
      <p>In terms of our goal for the end users' experiences, we wanted to create an interactive webpage which invited
        the users to dig in to the investigation themselves. Overall we wanted to present an overview of what people are
        saying about the war on Twitter, which main subjects are discussed and who people interact with within their
        spoken language.</p>
      <p>We aimed at presenting our findings in an user-friendly and comprehensible way using a variety of data
        visualisations and interactive network graphs. The webpage was designed to put emphasis on the time/language
        aspects of the analysis making it easy for the user to understand our results and focus on one area at a time.
        The interactive parts of the webpage invites the user to engage in the analysis themselves and furthermore it
        was our hope that these features would make the experience fun and more appealing to the user.</p>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h2 id="Basic-stats.-Let's-get-to-know-our-data.">Basic stats. Let's get to know our data.<a class="anchor-link"
          href="#Basic-stats.-Let's-get-to-know-our-data.">&#182;</a></h2>
    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p>The following sections of code include everything used for data preprocessing and cleaning. Due to the high
        memory usage and heavy computations, everything has been run on the hpc and is simply displayed here for
        documentation purposes.</p>
      <h5 id="Dataset">Dataset<a class="anchor-link" href="#Dataset">&#182;</a></h5>
      <p>The original dataset include tweet ids retrieved from Twitter using the Twitter streaming Api and include
        tweets from each day in the period 21-02-2022 to 15-04-2022. The dataset is available at the github repo: <a
          href="https://github.com/ehsanulhaq1/russo_ukraine_dataset">ehsanulhaq1/russo_ukraine_dataset</a>, where the
        authors are also listed.</p>
      <p>The tweet ids have been collected based on a range of keywords relevant to the war such as (russia, ukraine,
        putin, zelensky, russian, ukrainian, keiv, kyiv). However, the list of keywords were continuously updated by the
        authors during the period of the data collection, as more and more keywords became relevant for the crisis
        during the times of download. For access to the complete list of keywords, we refer to the original github (see
        link above). We reached out to the owner of the GitHub with the purpose of retrieving the specific keywords he
        used. Unfortunately he was not able to get back to us before the hand-in of the assignment. The Twitter
        streaming API tracked the requested key words and provided any tweet that contained any of the key words.</p>
      <h5 id="Tweet-ids">Tweet ids<a class="anchor-link" href="#Tweet-ids">&#182;</a></h5>
      <p>The first snippet of code seen below has been used to download the tweet ids from the original github repo. To
        make sure we had a uniform distribution of data during the whole period, we extracted 18.000 randomly chosen
        tweet ids from the github repo for each day. This yielded a dataset of approximately 1 million tweets (even
        though the original dataset included 3 million+ tweets). The reduction of the size of the dataset was a
        necessity in this project, as it would have been infeasible for us to use the entire original dataset due to
        heavy computations and high memory usage.</p>
      <p>We are, however, aware of the fact that our final dataset is only a subset of the original dataset and
        therefore only represents a subset of the discussion of the war on twitter. In order to cross section our subset
        of data to be as representative as possible of the full dataset, we extract the tweet ids for each day randomly
        (i.e. randomized on tweet upload time), as we already mentioned briefly earlier. Other factors contribute to
        this limitation as well. For example the key words used when collecting the tweet ids from Twitter controls
        which tweets are included and excluded from dataset. It is, however, obvious that many tweets within the subject
        of the Ukraine-Russian war will not include these keywords and therefore we must be aware of this limitation
        when making any conclusions based on our dataset.</p>

    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">tweepy</span> <span class="k">as</span> <span class="nn">tw</span>

<span class="kn">import</span> <span class="nn">nltk</span>
<span class="kn">from</span> <span class="nn">nltk.corpus</span> <span class="kn">import</span> <span class="n">stopwords</span>
<span class="kn">from</span> <span class="nn">nltk.stem</span> <span class="kn">import</span> <span class="n">PorterStemmer</span>
<span class="kn">from</span> <span class="nn">nltk</span> <span class="kn">import</span> <span class="n">word_tokenize</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">os</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">feb</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2022-02-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;/2022-02-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">+</span><span class="s2">&quot;_&quot;</span> <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span><span class="mi">29</span><span class="p">)]</span>
<span class="n">march</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2022-03-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;/2022-03-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span><span class="s2">&quot;_&quot;</span> <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">32</span><span class="p">)]</span>
<span class="n">april</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2022-04-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;/2022-04-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span><span class="s2">&quot;_&quot;</span> <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">16</span><span class="p">)]</span>
<span class="n">datedate</span> <span class="o">=</span> <span class="n">feb</span> <span class="o">+</span> <span class="n">march</span> <span class="o">+</span> <span class="n">april</span>

<span class="n">num_csv_pr_day</span> <span class="o">=</span> <span class="p">[</span><span class="mi">22</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>

<span class="n">ids</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">datedate</span><span class="p">)):</span>
    <span class="n">date_ids</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">num_csv_picks</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">num_csv_pr_day</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">csv_picks</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">num_csv_pr_day</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">num_csv_picks</span><span class="p">)</span>
    <span class="n">tweets_per_csv</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="mi">18000</span><span class="o">/</span><span class="n">num_csv_picks</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">csv_picks</span><span class="p">:</span>
        <span class="n">git_url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/ehsanulhaq1/russo_ukraine_dataset/main/&#39;</span><span class="o">+</span> <span class="n">datedate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.csv&#39;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">git_url</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">ids_temp</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">][:</span><span class="n">tweets_per_csv</span><span class="p">]</span>
        <span class="n">ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ids_temp</span><span class="p">)</span>

  
<span class="n">ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">ids</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>

<span class="n">ids_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span>
<span class="n">ids_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;ALL_IDS.csv&quot;</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h5 id="Downloading-the-tweets">Downloading the tweets<a class="anchor-link"
          href="#Downloading-the-tweets">&#182;</a></h5>
      <p>After retrieving the tweet ids, we use the Twitter Api v2 to collect the corresponding tweets from Twitter and
        saved them all in a .csv-file.</p>
      <p>Our dataset consists of 18.000 tweets distributed over 54 days, and the dataset include tweets from 651.363
        users in total. As the majority of the users do not allow tracking of geolocation, we were not able to save the
        countries/locations of the users and tweets as first intended. Instead we tracked the language used in each
        tweet and in total we found 32 languages.</p>
      <p>We saved the following 8 attributes for each tweet:</p>
      <ul>
        <li>text of tweet (“full_text”)</li>
        <li>hashtags (“entities.hashtags”)</li>
        <li>id of tweet (“id”)</li>
        <li>the name of the user of the tweet (“user.screen_name”)</li>
        <li>the user that the tweet is replying to (“in_reply_to_screen_name”) </li>
        <li>date of tweet upload (“created_at”)</li>
        <li>the language the tweet is written in (“lang”)</li>
        <li>the location of the tweet (if any) (“location”)</li>
      </ul>
      <p>The full text and hashtags were saved to be used in our text and discourse analysis later on. We used the
        creation date and written language of the tweet to filter the tweets on time and language, respectively, when
        performing the text and network analysis, and the tweet id and parent author were used to generate several
        social network graphs during the analysis.</p>

    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">consumer_key</span><span class="o">=</span> <span class="s1">&#39;insert consumer key here&#39;</span>
<span class="n">consumer_secret</span><span class="o">=</span> <span class="s1">&#39;insert consumer secret key here&#39;</span>
<span class="n">access_token</span><span class="o">=</span> <span class="s1">&#39;insert access token here&#39;</span>
<span class="n">access_token_secret</span><span class="o">=</span> <span class="s1">&#39;insert access token secret here&#39;</span>

<span class="n">auth</span> <span class="o">=</span> <span class="n">tw</span><span class="o">.</span><span class="n">OAuthHandler</span><span class="p">(</span><span class="n">consumer_key</span><span class="p">,</span> <span class="n">consumer_secret</span><span class="p">)</span>
<span class="n">auth</span><span class="o">.</span><span class="n">set_access_token</span><span class="p">(</span><span class="n">access_token</span><span class="p">,</span> <span class="n">access_token_secret</span><span class="p">)</span>
<span class="n">api</span> <span class="o">=</span> <span class="n">tw</span><span class="o">.</span><span class="n">API</span><span class="p">(</span><span class="n">auth</span><span class="p">,</span> <span class="n">wait_on_rate_limit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ALL_IDS</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;ALL_IDS.csv&quot;</span><span class="p">)</span>
<span class="n">ALL_IDS</span> <span class="o">=</span> <span class="n">ALL_IDS</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span> <span class="p">,</span> <span class="mi">1</span><span class="p">:]</span>
<span class="n">ALL_IDS</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ids&quot;</span><span class="p">]</span>
<span class="n">ALL_IDS</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">ALL_IDS</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#create pandas dataframe</span>
<span class="c1">#create pandas dataframe</span>
<span class="n">tweets_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="s1">&#39;tweet_type&#39;</span><span class="p">,</span><span class="s1">&#39;tweet_id&#39;</span><span class="p">,</span> <span class="s1">&#39;username&#39;</span><span class="p">,</span><span class="s1">&#39;parent_author&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;created_utc&#39;</span><span class="p">,</span> <span class="s1">&#39;location&#39;</span><span class="p">,</span><span class="s1">&#39;language&#39;</span><span class="p">,</span> <span class="s1">&#39;place&#39;</span><span class="p">])</span>

<span class="n">n</span><span class="o">=</span><span class="mi">100</span>
<span class="n">step_size</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1">#BIG LOOP</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ALL_IDS</span><span class="p">),</span> <span class="n">step_size</span><span class="p">):</span>
    <span class="n">batch</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">ALL_IDS</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">n</span><span class="p">])</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>
    <span class="n">n</span><span class="o">+=</span><span class="mi">100</span>

    <span class="c1"># fetching the statuses from the API</span>
    <span class="n">statuses</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">lookup_statuses</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span><span class="n">tweet_mode</span><span class="o">=</span><span class="s2">&quot;extended&quot;</span><span class="p">)</span>
    
    <span class="c1">#retrieve all tweet attributes</span>
    <span class="k">for</span> <span class="n">status</span> <span class="ow">in</span> <span class="n">statuses</span><span class="p">:</span>
        <span class="n">tweet_id</span> <span class="o">=</span> <span class="n">status</span><span class="o">.</span><span class="n">id</span>
        <span class="n">username</span> <span class="o">=</span> <span class="n">status</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">screen_name</span>
        
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="s2">&quot;retweeted_status&quot;</span><span class="p">):</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">status</span><span class="o">.</span><span class="n">retweeted_status</span><span class="o">.</span><span class="n">full_text</span>
            <span class="n">parent_author</span> <span class="o">=</span> <span class="n">status</span><span class="o">.</span><span class="n">retweeted_status</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">screen_name</span>
            <span class="n">tweet_type</span> <span class="o">=</span> <span class="s2">&quot;retweet&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">status</span><span class="o">.</span><span class="n">full_text</span>
            <span class="n">parent_author</span> <span class="o">=</span> <span class="n">status</span><span class="o">.</span><span class="n">in_reply_to_screen_name</span>
            <span class="k">if</span> <span class="n">parent_author</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">tweet_type</span> <span class="o">=</span> <span class="s2">&quot;reply&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tweet_type</span> <span class="o">=</span> <span class="s2">&quot;original&quot;</span>
    
        <span class="n">created</span> <span class="o">=</span> <span class="n">status</span><span class="o">.</span><span class="n">created_at</span>
        <span class="n">location</span> <span class="o">=</span> <span class="n">status</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">location</span>
        <span class="n">language</span> <span class="o">=</span> <span class="n">status</span><span class="o">.</span><span class="n">lang</span>
        <span class="n">place</span> <span class="o">=</span> <span class="n">status</span><span class="o">.</span><span class="n">place</span>

        <span class="c1">#gather tweet attributes</span>
        <span class="n">tweet_attribitues</span> <span class="o">=</span> <span class="p">[</span><span class="n">text</span><span class="p">,</span> <span class="n">tweet_type</span><span class="p">,</span> <span class="n">tweet_id</span><span class="p">,</span><span class="n">username</span><span class="p">,</span> <span class="n">parent_author</span><span class="p">,</span> <span class="n">created</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">language</span><span class="p">,</span><span class="n">place</span><span class="p">]</span>
        
        <span class="c1"># Append to dataframe</span>
        <span class="n">tweets_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">tweets_df</span><span class="p">)]</span> <span class="o">=</span> <span class="n">tweet_attribitues</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tweets_df</span><span class="p">)</span> <span class="o">%</span> <span class="mi">25000</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">tweets_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_tester_data.csv&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
            <span class="n">tweets_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="s1">&#39;tweet_type&#39;</span><span class="p">,</span><span class="s1">&#39;tweet_id&#39;</span><span class="p">,</span> <span class="s1">&#39;username&#39;</span><span class="p">,</span><span class="s1">&#39;parent_author&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;created_utc&#39;</span><span class="p">,</span> <span class="s1">&#39;location&#39;</span><span class="p">,</span><span class="s1">&#39;language&#39;</span><span class="p">,</span> <span class="s1">&#39;place&#39;</span><span class="p">])</span>
  
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># concatenating all .csv-files in one</span>

<span class="n">path</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;data_collection/&#39;</span>
<span class="n">all_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;*.csv&quot;</span><span class="p">))</span> 

<span class="n">df_from_each_file</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">)</span>
<span class="n">concatenated_df</span>   <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_from_each_file</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">concatenated_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;ALL_DIRTY_TWEETS.csv&quot;</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h5 id="Cleaning-the-data">Cleaning the data<a class="anchor-link" href="#Cleaning-the-data">&#182;</a></h5>
      <p>After extracting all tweets, we performed multiple steps of data cleaning before using the data for analysis.
        The following major steps were performed on all tweets in our data cleaning-process:</p>
      <ul>
        <li>All tweets were translated to English in order to 1) make the tweets understandable for the us and 2) be
          able to use all kinds of analysis tools using an English corpus on all of the tweets in our dataset. </li>
        <li>Tweets were transformed to lowercase </li>
        <li>Tweets used for the analysis (with the exception of the wordshift analysis) were stemmed (using the Porter
          Stemmer from nltk). We chose to perform lowercasing and stemming in order to treat all variations of one word
          as the same.</li>
        <li>Stopwords were removed in order to remove irrelevant and uninformative words from the analysis.</li>
        <li>Only alpha-numeric letters. were saved in order to filter out any other unknown sort of symbols (such as
          emojies)</li>
        <li>All hashtags in each tweet were found and saved for analysis later on.</li>
        <li>The tweets were tokenized.</li>
      </ul>
      <p>The code used for this process can be seen below.</p>

    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="kn">from</span> <span class="nn">deep_translator</span> <span class="kn">import</span> <span class="n">GoogleTranslator</span>

<span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;stopwords&#39;</span><span class="p">)</span>
<span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;punkt&#39;</span><span class="p">)</span>
<span class="n">stopword_vocab</span> <span class="o">=</span> <span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">&#39;english&#39;</span><span class="p">)</span>
<span class="n">ps</span> <span class="o">=</span> <span class="n">PorterStemmer</span><span class="p">()</span>

<span class="c1"># the following functions can be applied to a df with pandas apply function</span>

<span class="c1"># translate text to english</span>
<span class="k">def</span> <span class="nf">translate_text</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;en&#39;</span><span class="p">):</span>
    <span class="n">lang_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;afrikaans&#39;</span><span class="p">:</span> <span class="s1">&#39;af&#39;</span><span class="p">,</span> <span class="s1">&#39;albanian&#39;</span><span class="p">:</span> <span class="s1">&#39;sq&#39;</span><span class="p">,</span> <span class="s1">&#39;amharic&#39;</span><span class="p">:</span> <span class="s1">&#39;am&#39;</span><span class="p">,</span> <span class="s1">&#39;arabic&#39;</span><span class="p">:</span> <span class="s1">&#39;ar&#39;</span><span class="p">,</span> <span class="s1">&#39;armenian&#39;</span><span class="p">:</span> <span class="s1">&#39;hy&#39;</span><span class="p">,</span> <span class="s1">&#39;azerbaijani&#39;</span><span class="p">:</span> <span class="s1">&#39;az&#39;</span><span class="p">,</span> <span class="s1">&#39;basque&#39;</span><span class="p">:</span> <span class="s1">&#39;eu&#39;</span><span class="p">,</span> <span class="s1">&#39;belarusian&#39;</span><span class="p">:</span> <span class="s1">&#39;be&#39;</span><span class="p">,</span> <span class="s1">&#39;bengali&#39;</span><span class="p">:</span> <span class="s1">&#39;bn&#39;</span><span class="p">,</span> <span class="s1">&#39;bosnian&#39;</span><span class="p">:</span> <span class="s1">&#39;bs&#39;</span><span class="p">,</span> <span class="s1">&#39;bulgarian&#39;</span><span class="p">:</span> <span class="s1">&#39;bg&#39;</span><span class="p">,</span> <span class="s1">&#39;catalan&#39;</span><span class="p">:</span> <span class="s1">&#39;ca&#39;</span><span class="p">,</span> <span class="s1">&#39;cebuano&#39;</span><span class="p">:</span> <span class="s1">&#39;ceb&#39;</span><span class="p">,</span> <span class="s1">&#39;chichewa&#39;</span><span class="p">:</span> <span class="s1">&#39;ny&#39;</span><span class="p">,</span> <span class="s1">&#39;chinese (simplified)&#39;</span><span class="p">:</span> <span class="s1">&#39;zh-CN&#39;</span><span class="p">,</span> <span class="s1">&#39;chinese (traditional)&#39;</span><span class="p">:</span> <span class="s1">&#39;zh-TW&#39;</span><span class="p">,</span> <span class="s1">&#39;corsican&#39;</span><span class="p">:</span> <span class="s1">&#39;co&#39;</span><span class="p">,</span> <span class="s1">&#39;croatian&#39;</span><span class="p">:</span> <span class="s1">&#39;hr&#39;</span><span class="p">,</span> <span class="s1">&#39;czech&#39;</span><span class="p">:</span> <span class="s1">&#39;cs&#39;</span><span class="p">,</span> <span class="s1">&#39;danish&#39;</span><span class="p">:</span> <span class="s1">&#39;da&#39;</span><span class="p">,</span> <span class="s1">&#39;dutch&#39;</span><span class="p">:</span> <span class="s1">&#39;nl&#39;</span><span class="p">,</span> <span class="s1">&#39;english&#39;</span><span class="p">:</span> <span class="s1">&#39;en&#39;</span><span class="p">,</span> <span class="s1">&#39;esperanto&#39;</span><span class="p">:</span> <span class="s1">&#39;eo&#39;</span><span class="p">,</span> <span class="s1">&#39;estonian&#39;</span><span class="p">:</span> <span class="s1">&#39;et&#39;</span><span class="p">,</span> <span class="s1">&#39;filipino&#39;</span><span class="p">:</span> <span class="s1">&#39;tl&#39;</span><span class="p">,</span> <span class="s1">&#39;finnish&#39;</span><span class="p">:</span> <span class="s1">&#39;fi&#39;</span><span class="p">,</span> <span class="s1">&#39;french&#39;</span><span class="p">:</span> <span class="s1">&#39;fr&#39;</span><span class="p">,</span> <span class="s1">&#39;frisian&#39;</span><span class="p">:</span> <span class="s1">&#39;fy&#39;</span><span class="p">,</span> <span class="s1">&#39;galician&#39;</span><span class="p">:</span> <span class="s1">&#39;gl&#39;</span><span class="p">,</span> <span class="s1">&#39;georgian&#39;</span><span class="p">:</span> <span class="s1">&#39;ka&#39;</span><span class="p">,</span> <span class="s1">&#39;german&#39;</span><span class="p">:</span> <span class="s1">&#39;de&#39;</span><span class="p">,</span> <span class="s1">&#39;greek&#39;</span><span class="p">:</span> <span class="s1">&#39;el&#39;</span><span class="p">,</span> <span class="s1">&#39;gujarati&#39;</span><span class="p">:</span> <span class="s1">&#39;gu&#39;</span><span class="p">,</span> <span class="s1">&#39;haitian creole&#39;</span><span class="p">:</span> <span class="s1">&#39;ht&#39;</span><span class="p">,</span> <span class="s1">&#39;hausa&#39;</span><span class="p">:</span> <span class="s1">&#39;ha&#39;</span><span class="p">,</span> <span class="s1">&#39;hawaiian&#39;</span><span class="p">:</span> <span class="s1">&#39;haw&#39;</span><span class="p">,</span> <span class="s1">&#39;hebrew&#39;</span><span class="p">:</span> <span class="s1">&#39;iw&#39;</span><span class="p">,</span> <span class="s1">&#39;hindi&#39;</span><span class="p">:</span> <span class="s1">&#39;hi&#39;</span><span class="p">,</span> <span class="s1">&#39;hmong&#39;</span><span class="p">:</span> <span class="s1">&#39;hmn&#39;</span><span class="p">,</span> <span class="s1">&#39;hungarian&#39;</span><span class="p">:</span> <span class="s1">&#39;hu&#39;</span><span class="p">,</span> <span class="s1">&#39;icelandic&#39;</span><span class="p">:</span> <span class="s1">&#39;is&#39;</span><span class="p">,</span> <span class="s1">&#39;igbo&#39;</span><span class="p">:</span> <span class="s1">&#39;ig&#39;</span><span class="p">,</span> <span class="s1">&#39;indonesian&#39;</span><span class="p">:</span> <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;irish&#39;</span><span class="p">:</span> <span class="s1">&#39;ga&#39;</span><span class="p">,</span> <span class="s1">&#39;italian&#39;</span><span class="p">:</span> <span class="s1">&#39;it&#39;</span><span class="p">,</span> <span class="s1">&#39;japanese&#39;</span><span class="p">:</span> <span class="s1">&#39;ja&#39;</span><span class="p">,</span> <span class="s1">&#39;javanese&#39;</span><span class="p">:</span> <span class="s1">&#39;jw&#39;</span><span class="p">,</span> <span class="s1">&#39;kannada&#39;</span><span class="p">:</span> <span class="s1">&#39;kn&#39;</span><span class="p">,</span> <span class="s1">&#39;kazakh&#39;</span><span class="p">:</span> <span class="s1">&#39;kk&#39;</span><span class="p">,</span> <span class="s1">&#39;khmer&#39;</span><span class="p">:</span> <span class="s1">&#39;km&#39;</span><span class="p">,</span> <span class="s1">&#39;kinyarwanda&#39;</span><span class="p">:</span> <span class="s1">&#39;rw&#39;</span><span class="p">,</span> <span class="s1">&#39;korean&#39;</span><span class="p">:</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="s1">&#39;kurdish&#39;</span><span class="p">:</span> <span class="s1">&#39;ku&#39;</span><span class="p">,</span> <span class="s1">&#39;kyrgyz&#39;</span><span class="p">:</span> <span class="s1">&#39;ky&#39;</span><span class="p">,</span> <span class="s1">&#39;lao&#39;</span><span class="p">:</span> <span class="s1">&#39;lo&#39;</span><span class="p">,</span> <span class="s1">&#39;latin&#39;</span><span class="p">:</span> <span class="s1">&#39;la&#39;</span><span class="p">,</span> <span class="s1">&#39;latvian&#39;</span><span class="p">:</span> <span class="s1">&#39;lv&#39;</span><span class="p">,</span> <span class="s1">&#39;lithuanian&#39;</span><span class="p">:</span> <span class="s1">&#39;lt&#39;</span><span class="p">,</span> <span class="s1">&#39;luxembourgish&#39;</span><span class="p">:</span> <span class="s1">&#39;lb&#39;</span><span class="p">,</span> <span class="s1">&#39;macedonian&#39;</span><span class="p">:</span> <span class="s1">&#39;mk&#39;</span><span class="p">,</span> <span class="s1">&#39;malagasy&#39;</span><span class="p">:</span> <span class="s1">&#39;mg&#39;</span><span class="p">,</span> <span class="s1">&#39;malay&#39;</span><span class="p">:</span> <span class="s1">&#39;ms&#39;</span><span class="p">,</span> <span class="s1">&#39;malayalam&#39;</span><span class="p">:</span> <span class="s1">&#39;ml&#39;</span><span class="p">,</span> <span class="s1">&#39;maltese&#39;</span><span class="p">:</span> <span class="s1">&#39;mt&#39;</span><span class="p">,</span> <span class="s1">&#39;maori&#39;</span><span class="p">:</span> <span class="s1">&#39;mi&#39;</span><span class="p">,</span> <span class="s1">&#39;marathi&#39;</span><span class="p">:</span> <span class="s1">&#39;mr&#39;</span><span class="p">,</span> <span class="s1">&#39;mongolian&#39;</span><span class="p">:</span> <span class="s1">&#39;mn&#39;</span><span class="p">,</span> <span class="s1">&#39;myanmar&#39;</span><span class="p">:</span> <span class="s1">&#39;my&#39;</span><span class="p">,</span> <span class="s1">&#39;nepali&#39;</span><span class="p">:</span> <span class="s1">&#39;ne&#39;</span><span class="p">,</span> <span class="s1">&#39;norwegian&#39;</span><span class="p">:</span> <span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="s1">&#39;odia&#39;</span><span class="p">:</span> <span class="s1">&#39;or&#39;</span><span class="p">,</span> <span class="s1">&#39;pashto&#39;</span><span class="p">:</span> <span class="s1">&#39;ps&#39;</span><span class="p">,</span> <span class="s1">&#39;persian&#39;</span><span class="p">:</span> <span class="s1">&#39;fa&#39;</span><span class="p">,</span> <span class="s1">&#39;polish&#39;</span><span class="p">:</span> <span class="s1">&#39;pl&#39;</span><span class="p">,</span> <span class="s1">&#39;portuguese&#39;</span><span class="p">:</span> <span class="s1">&#39;pt&#39;</span><span class="p">,</span> <span class="s1">&#39;punjabi&#39;</span><span class="p">:</span> <span class="s1">&#39;pa&#39;</span><span class="p">,</span> <span class="s1">&#39;romanian&#39;</span><span class="p">:</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="s1">&#39;russian&#39;</span><span class="p">:</span> <span class="s1">&#39;ru&#39;</span><span class="p">,</span> <span class="s1">&#39;samoan&#39;</span><span class="p">:</span> <span class="s1">&#39;sm&#39;</span><span class="p">,</span> <span class="s1">&#39;scots gaelic&#39;</span><span class="p">:</span> <span class="s1">&#39;gd&#39;</span><span class="p">,</span> <span class="s1">&#39;serbian&#39;</span><span class="p">:</span> <span class="s1">&#39;sr&#39;</span><span class="p">,</span> <span class="s1">&#39;sesotho&#39;</span><span class="p">:</span> <span class="s1">&#39;st&#39;</span><span class="p">,</span> <span class="s1">&#39;shona&#39;</span><span class="p">:</span> <span class="s1">&#39;sn&#39;</span><span class="p">,</span> <span class="s1">&#39;sindhi&#39;</span><span class="p">:</span> <span class="s1">&#39;sd&#39;</span><span class="p">,</span> <span class="s1">&#39;sinhala&#39;</span><span class="p">:</span> <span class="s1">&#39;si&#39;</span><span class="p">,</span> <span class="s1">&#39;slovak&#39;</span><span class="p">:</span> <span class="s1">&#39;sk&#39;</span><span class="p">,</span> <span class="s1">&#39;slovenian&#39;</span><span class="p">:</span> <span class="s1">&#39;sl&#39;</span><span class="p">,</span> <span class="s1">&#39;somali&#39;</span><span class="p">:</span> <span class="s1">&#39;so&#39;</span><span class="p">,</span> <span class="s1">&#39;spanish&#39;</span><span class="p">:</span> <span class="s1">&#39;es&#39;</span><span class="p">,</span> <span class="s1">&#39;sundanese&#39;</span><span class="p">:</span> <span class="s1">&#39;su&#39;</span><span class="p">,</span> <span class="s1">&#39;swahili&#39;</span><span class="p">:</span> <span class="s1">&#39;sw&#39;</span><span class="p">,</span> <span class="s1">&#39;swedish&#39;</span><span class="p">:</span> <span class="s1">&#39;sv&#39;</span><span class="p">,</span> <span class="s1">&#39;tajik&#39;</span><span class="p">:</span> <span class="s1">&#39;tg&#39;</span><span class="p">,</span> <span class="s1">&#39;tamil&#39;</span><span class="p">:</span> <span class="s1">&#39;ta&#39;</span><span class="p">,</span> <span class="s1">&#39;tatar&#39;</span><span class="p">:</span> <span class="s1">&#39;tt&#39;</span><span class="p">,</span> <span class="s1">&#39;telugu&#39;</span><span class="p">:</span> <span class="s1">&#39;te&#39;</span><span class="p">,</span> <span class="s1">&#39;thai&#39;</span><span class="p">:</span> <span class="s1">&#39;th&#39;</span><span class="p">,</span> <span class="s1">&#39;turkish&#39;</span><span class="p">:</span> <span class="s1">&#39;tr&#39;</span><span class="p">,</span> <span class="s1">&#39;turkmen&#39;</span><span class="p">:</span> <span class="s1">&#39;tk&#39;</span><span class="p">,</span> <span class="s1">&#39;ukrainian&#39;</span><span class="p">:</span> <span class="s1">&#39;uk&#39;</span><span class="p">,</span> <span class="s1">&#39;urdu&#39;</span><span class="p">:</span> <span class="s1">&#39;ur&#39;</span><span class="p">,</span> <span class="s1">&#39;uyghur&#39;</span><span class="p">:</span> <span class="s1">&#39;ug&#39;</span><span class="p">,</span> <span class="s1">&#39;uzbek&#39;</span><span class="p">:</span> <span class="s1">&#39;uz&#39;</span><span class="p">,</span> <span class="s1">&#39;vietnamese&#39;</span><span class="p">:</span> <span class="s1">&#39;vi&#39;</span><span class="p">,</span> <span class="s1">&#39;welsh&#39;</span><span class="p">:</span> <span class="s1">&#39;cy&#39;</span><span class="p">,</span> <span class="s1">&#39;xhosa&#39;</span><span class="p">:</span> <span class="s1">&#39;xh&#39;</span><span class="p">,</span> <span class="s1">&#39;yiddish&#39;</span><span class="p">:</span> <span class="s1">&#39;yi&#39;</span><span class="p">,</span> <span class="s1">&#39;yoruba&#39;</span><span class="p">:</span> <span class="s1">&#39;yo&#39;</span><span class="p">,</span> <span class="s1">&#39;zulu&#39;</span><span class="p">:</span> <span class="s1">&#39;zu&#39;</span><span class="p">}</span>
    
    <span class="k">if</span> <span class="n">source</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">lang_dict</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">return</span> <span class="s1">&#39;und&#39;</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">GoogleTranslator</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">)</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

<span class="c1"># lowercase all letters in text</span>
<span class="k">def</span> <span class="nf">lowercase</span><span class="p">(</span><span class="n">txt</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">txt</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

<span class="c1"># removes emojis, links, special characters, hashtags</span>
<span class="k">def</span> <span class="nf">remove_links_special_characters</span><span class="p">(</span><span class="n">txt</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;(@[A-Za-z0-9]+)|([^0-9A-Za-z </span><span class="se">\t</span><span class="s2">])|(\w+:\/\/\S+)&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">txt</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> 

<span class="c1"># find all hashtags - might not be necessary if it is properly in data </span>
<span class="k">def</span> <span class="nf">find_hashtags</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">found_hashtags</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;#\w+&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">tick</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span> <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">found_hashtags</span><span class="p">]</span>

<span class="c1"># tokenize the tweets + remove stopwords</span>
<span class="k">def</span> <span class="nf">tokenize_text</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">stem</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">stem</span><span class="p">:</span>
        <span class="n">filtered</span> <span class="o">=</span> <span class="p">[</span><span class="n">ps</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">word_tokenize</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> 
                    <span class="k">if</span> <span class="n">w</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()</span> <span class="ow">and</span> <span class="n">w</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stopword_vocab</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">filtered</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">word_tokenize</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> 
                    <span class="k">if</span> <span class="n">w</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()</span> <span class="ow">and</span> <span class="n">w</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stopword_vocab</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">filtered</span>


<span class="k">def</span> <span class="nf">clean_tweet</span><span class="p">(</span><span class="n">tweet</span><span class="p">,</span> <span class="n">language</span><span class="p">):</span>
    <span class="n">clean_tw</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">tweet</span><span class="p">)</span>

    <span class="c1"># finds the hashtags (need to be done in og language)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">hashtags</span> <span class="o">=</span> <span class="n">find_hashtags</span><span class="p">(</span><span class="n">clean_tw</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">hashtags</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># lowercase - before or after hashtag? </span>
    <span class="n">clean_tw</span> <span class="o">=</span> <span class="n">lowercase</span><span class="p">(</span><span class="n">clean_tw</span><span class="p">)</span>

    <span class="c1"># translate only if the language is not english</span>
    <span class="k">if</span> <span class="n">language</span> <span class="o">!=</span> <span class="p">(</span><span class="s1">&#39;en&#39;</span><span class="p">):</span>
        <span class="n">clean_tw</span> <span class="o">=</span> <span class="n">translate_text</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">clean_tw</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">language</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;en&#39;</span><span class="p">)</span>

        <span class="c1">#translate hashtags</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">hashtags</span> <span class="o">=</span> <span class="p">[</span><span class="n">translate_text</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">language</span><span class="p">)</span> <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">hashtags</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">hashtags</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># clean up in text (remove links, special characters etc.)</span>
    <span class="n">clean_tw</span> <span class="o">=</span> <span class="n">remove_links_special_characters</span><span class="p">(</span><span class="n">clean_tw</span><span class="p">)</span>

    <span class="n">tokenized</span> <span class="o">=</span> <span class="n">tokenize_text</span><span class="p">(</span><span class="n">clean_tw</span><span class="p">,</span> <span class="n">stem</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">tokenized_stemmed</span> <span class="o">=</span> <span class="n">tokenize_text</span><span class="p">(</span><span class="n">clean_tw</span><span class="p">,</span> <span class="n">stem</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
 
    <span class="k">return</span> <span class="p">(</span><span class="n">clean_tw</span><span class="p">,</span> <span class="n">hashtags</span><span class="p">,</span> <span class="n">tokenized</span><span class="p">,</span> <span class="n">tokenized_stemmed</span><span class="p">)</span>


<span class="n">all_dirty_tweets_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;ALL_DIRTY_TWEETS.csv&#39;</span><span class="p">)</span>
    
<span class="n">clean_results</span> <span class="o">=</span> <span class="n">all_dirty_tweets_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">clean_tweet</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;language&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">all_dirty_tweets_df</span><span class="p">[[</span><span class="s1">&#39;translated_text&#39;</span><span class="p">,</span><span class="s1">&#39;translated_hashtags&#39;</span><span class="p">,</span><span class="s1">&#39;tokenized_text&#39;</span><span class="p">,</span><span class="s1">&#39;tokenized_text_stemmed&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">clean_results</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;translated_text&#39;</span><span class="p">,</span> <span class="s1">&#39;translated_hashtags&#39;</span><span class="p">,</span> <span class="s1">&#39;tokenized_text&#39;</span><span class="p">,</span> <span class="s1">&#39;tokenized_text_stemmed&#39;</span><span class="p">])</span>

<span class="n">all_dirty_tweets_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;ALL_TWEETS_CLEAN.csv&#39;</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h3 id="Understanding-the-volume-volatility-of-the-data">Understanding the volume volatility of the data<a
          class="anchor-link" href="#Understanding-the-volume-volatility-of-the-data">&#182;</a></h3>
    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p>We created a plot over the volume of tweets per day for the english, ukranian and russian language
        respectively. This was done to get an overview of the volume for the different languages we were analysing. The
        actual volume graph was created in HTML, but the data for the graph was extracted in python and the extraction
        code can be seen below.</p>

    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dt</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1">#reading data:</span>
<span class="n">data_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;/work/data/ALL_CLEAN_TWEETS.csv&quot;</span><span class="p">,</span><span class="n">converters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;tokenized_text&#39;</span><span class="p">:</span> <span class="nb">eval</span><span class="p">,</span><span class="s1">&#39;tokenized_text_stemmed&#39;</span><span class="p">:</span> <span class="nb">eval</span><span class="p">,</span><span class="s2">&quot;translated_hashtags&quot;</span><span class="p">:</span> <span class="nb">eval</span> <span class="p">})</span>

<span class="c1"># make timestamp to a datetime object</span>
<span class="n">data_df</span><span class="p">[</span><span class="s2">&quot;date_created&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;created_utc&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="n">data_df</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_df</span><span class="p">[</span><span class="s2">&quot;date_created&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">date</span>

<span class="n">data_df</span><span class="p">[</span><span class="s2">&quot;translated_text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_df</span><span class="p">[</span><span class="s2">&quot;translated_text&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># run the following cells for &#39;ru&#39;, &#39;en&#39; and &#39;uk&#39;</span>
<span class="n">volume_df</span> <span class="o">=</span> <span class="n">data_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_df</span><span class="o">.</span><span class="n">language</span><span class="o">==</span><span class="s1">&#39;ru&#39;</span><span class="p">][</span><span class="s1">&#39;date_created&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1">#to list so we can put it directly into the html chart.js code</span>
<span class="p">[</span><span class="n">date_obj</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">date_obj</span> <span class="ow">in</span> <span class="n">volume_df</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]]</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1">#to list so we can put it directly into the html chart.js code</span>
<span class="n">volume_df</span><span class="o">.</span><span class="n">date_created</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p><img src="assets/imgs/tweet_volume.png" alt="Tweet Volume Plot" /></p>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p>It is easy to see that the volume of tweets written in english far succeeds the tweets written in ukranian and
        russian respectively. This is only expected as the english language has an overall higher volume of people
        speaking it. However, this leads to english hashtag trends and keywords possibly dominating in the analysis
        where we are not splitting by language.</p>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h2 id="Tools,-theory-and-analysis.-From-theory-to-insights.">Tools, theory and analysis. From theory to
        insights.<a class="anchor-link" href="#Tools,-theory-and-analysis.-From-theory-to-insights.">&#182;</a></h2>
    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h3 id="Text-analysis">Text analysis<a class="anchor-link" href="#Text-analysis">&#182;</a></h3>
    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h4 id="Dispersion-Plot-of-Important-Words">Dispersion Plot of Important Words<a class="anchor-link"
          href="#Dispersion-Plot-of-Important-Words">&#182;</a></h4>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1">#reading data:</span>
<span class="n">data_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;/work/data/ALL_CLEAN_TWEETS.csv&quot;</span><span class="p">,</span><span class="n">converters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;tokenized_text&#39;</span><span class="p">:</span> <span class="nb">eval</span><span class="p">,</span><span class="s1">&#39;tokenized_text_stemmed&#39;</span><span class="p">:</span> <span class="nb">eval</span><span class="p">,</span><span class="s2">&quot;translated_hashtags&quot;</span><span class="p">:</span> <span class="nb">eval</span> <span class="p">})</span>

<span class="c1"># make timestamp to a datetime object</span>
<span class="n">data_df</span><span class="p">[</span><span class="s2">&quot;date_created&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;created_utc&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="n">data_df</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_df</span><span class="p">[</span><span class="s2">&quot;date_created&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">date</span>

<span class="n">data_df</span><span class="p">[</span><span class="s2">&quot;translated_text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_df</span><span class="p">[</span><span class="s2">&quot;translated_text&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># we need the date, language and the text to do the dispersion plot</span>
<span class="n">lexical_df</span> <span class="o">=</span> <span class="n">data_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_df</span><span class="o">.</span><span class="n">language</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;en&#39;</span><span class="p">,</span> <span class="s1">&#39;ru&#39;</span><span class="p">,</span> <span class="s1">&#39;uk&#39;</span><span class="p">])][[</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;language&#39;</span><span class="p">,</span> <span class="s1">&#39;translated_text&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">lexical_df</span><span class="p">[</span><span class="s1">&#39;translated_text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lexical_df</span><span class="p">[</span><span class="s1">&#39;translated_text&#39;</span><span class="p">]</span>

<span class="c1"># we create our list of important wors</span>
<span class="n">words</span> <span class="o">=</span> <span class="s2">&quot;belarus|loot|glory|vasylkiv|oil|economy|chernobyl| nuclear war&quot;</span>

<span class="c1"># we find all the important words in the tweets</span>
<span class="n">lexical_df</span><span class="p">[</span><span class="s1">&#39;words&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lexical_df</span><span class="o">.</span><span class="n">translated_text</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>

<span class="c1"># we explode the dataframe to have single important words per row</span>
<span class="n">lexical_df</span> <span class="o">=</span> <span class="n">lexical_df</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="s1">&#39;words&#39;</span><span class="p">)</span>
<span class="n">lexical_df</span> <span class="o">=</span> <span class="n">lexical_df</span><span class="p">[</span><span class="n">lexical_df</span><span class="p">[</span><span class="s1">&#39;words&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()]</span>
<span class="n">lexical_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># plotting the dispersion plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;words&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">lexical_df</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;language&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span> <span class="o">=</span> <span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">bbox_to_anchor</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;dispersion.png&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p><img src="assets/imgs/dispersion.png" alt="Dispersion Plot" /></p>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h5 id="Analyses-of-dispersion-plot">Analyses of dispersion plot<a class="anchor-link"
          href="#Analyses-of-dispersion-plot">&#182;</a></h5>
      <p>Our initial intention with the dispersion plot was to use it to locate events or trends in time regarding the
        war. However, after numerous trials with different words we had to conclude that the dispersion plot does not
        show significant differences between the magnitude of usage of words.</p>
      <p>We do, however, see a few interesting tendencies in the dispersion plot above. First of all, the use of the
        Ukranian city name "Vasylkiv" peaks around the 25th-28th February 2022, then again around 12th March 2022 and
        lastly in the period of 1st-4th April 2022. These dates (/periods in time) corresponds to the dates of the
        initial and second attack on the city and the declaration of liberation from Russian invaders, respectively <a
          href="https://www.theguardian.com/world/2022/feb/28/vasylkiv-why-this-small-ukrainian-town-is-now-a-big-russian-target">(www.theguardian.com)</a>.
      </p>
      <p>Furthermore the word "glory" was used mostly by the Russians around February 28th 2022, which was a few days
        after the first attacks in the Russian invasion of Ukraine and this may be imply that the Russians were rather
        optimistic at this point in time. The word "economy" was used significantly more by the Russians than the other
        languages on March 8th 2022 which is appriximately a week after the West started to impose economical sanctions
        on Russia(ns). It can also be seen that the expression "nuclear war" seemed to be used more by the Russians
        around April 1st. We did not find any particular big events regarding this on the exact date but the debate of
        whether a nuclear war was a significant threat did rise during April 2022 so there may be some connection here.
      </p>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h4 id="Wordshift-Graphs">Wordshift Graphs<a class="anchor-link" href="#Wordshift-Graphs">&#182;</a></h4>
      <p>how they were made</p>

    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">import</span> <span class="nn">shifterator</span> <span class="k">as</span> <span class="nn">sh</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1">#reading data:</span>
<span class="n">data_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;/work/data/ALL_CLEAN_TWEETS.csv&quot;</span><span class="p">,</span><span class="n">converters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;tokenized_text&#39;</span><span class="p">:</span> <span class="nb">eval</span><span class="p">,</span><span class="s1">&#39;tokenized_text_stemmed&#39;</span><span class="p">:</span> <span class="nb">eval</span><span class="p">,</span><span class="s2">&quot;translated_hashtags&quot;</span><span class="p">:</span> <span class="nb">eval</span> <span class="p">})</span>

<span class="c1"># make timestamp to a datetime object</span>
<span class="n">data_df</span><span class="p">[</span><span class="s2">&quot;date_created&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;created_utc&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="n">data_df</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_df</span><span class="p">[</span><span class="s2">&quot;date_created&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">date</span>

<span class="n">data_df</span><span class="p">[</span><span class="s2">&quot;translated_text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_df</span><span class="p">[</span><span class="s2">&quot;translated_text&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h5 id="Russian-vs-Ukranian-Wordshift">Russian vs Ukranian Wordshift<a class="anchor-link"
          href="#Russian-vs-Ukranian-Wordshift">&#182;</a></h5>
    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <ul>
        <li>We start out by building two lists $l_{ru}$ and $l_{uk}$. These lists contain all the tokens for tweets on
          russian and ukranian respectively.</li>
        <li>For each hashtag $i$ we compute the relative frequency in the two lists $l_{ru}$ and $l_{uk}$. These are
          saved in the script as variables called p_ru and p_uk. In order to compute the relative frequency, we compute
          the number of times a token occurs over the total length of the document (the document is in this case all of
          the tokenized tweet text for the given language). </li>
        <li>Then for each of the tokens, the happiness $h(i) = labMT(i) - 5$ is computed. We subtract 5 because we want
          the positive tokens to have a positive value, while the negative tokens gets a negative value. We use the
          labMT dictionary in order to compute the happiness scores for each token. Lastly we compute $\delta \Phi =
          h(i)\cdot \delta p(i)$.</li>
      </ul>

    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1">#making different dataframes for ukranian tweets and russian tweets</span>
<span class="n">lang_ru</span> <span class="o">=</span> <span class="n">data_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_df</span><span class="o">.</span><span class="n">language</span><span class="o">==</span><span class="s1">&#39;ru&#39;</span><span class="p">]</span>
<span class="n">lang_uk</span> <span class="o">=</span> <span class="n">data_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_df</span><span class="o">.</span><span class="n">language</span><span class="o">==</span><span class="s1">&#39;uk&#39;</span><span class="p">]</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1">#explode the tokenized text columns to only contain single strings instead of lists</span>
<span class="n">l_ru</span> <span class="o">=</span> <span class="n">lang_ru</span><span class="o">.</span><span class="n">tokenized_text</span><span class="o">.</span><span class="n">explode</span><span class="p">()</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<span class="n">l_uk</span> <span class="o">=</span> <span class="n">lang_uk</span><span class="o">.</span><span class="n">tokenized_text</span><span class="o">.</span><span class="n">explode</span><span class="p">()</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">p_ru</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">l_ru</span><span class="p">))</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="n">Counter</span><span class="p">(</span><span class="n">l_ru</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
<span class="n">p_uk</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">l_uk</span><span class="p">))</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="n">Counter</span><span class="p">(</span><span class="n">l_uk</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>

<span class="n">all_tokens</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">p_ru</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">p_uk</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<span class="n">dp</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">token</span><span class="p">,</span><span class="n">p_ru</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">token</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">p_uk</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">token</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">all_tokens</span><span class="p">])</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="nb">sorted</span><span class="p">(</span><span class="n">dp</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span><span class="n">key</span><span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">token</span><span class="p">,</span><span class="n">lab_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">token</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">all_tokens</span><span class="p">])</span>
<span class="n">dPhi</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">token</span><span class="p">,</span> <span class="n">h</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="o">*</span> <span class="n">dp</span><span class="p">[</span><span class="n">token</span><span class="p">])</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">all_tokens</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">token</span><span class="p">])])</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="nb">sorted</span><span class="p">(</span><span class="n">dPhi</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span><span class="n">key</span><span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:</span><span class="mi">11</span><span class="p">]</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">sentiment_shift</span> <span class="o">=</span> <span class="n">sh</span><span class="o">.</span><span class="n">WeightedAvgShift</span><span class="p">(</span><span class="n">type2freq_1</span> <span class="o">=</span> <span class="n">p_ru</span><span class="p">,</span>
                     <span class="n">type2freq_2</span> <span class="o">=</span> <span class="n">p_uk</span><span class="p">,</span>
                       <span class="n">type2score_1</span> <span class="o">=</span> <span class="n">lab_dict</span><span class="p">,</span>
                   <span class="n">reference_value</span> <span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">sentiment_shift</span><span class="o">.</span><span class="n">get_shift_graph</span><span class="p">(</span><span class="n">detailed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">system_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Russian&quot;</span><span class="p">,</span><span class="s2">&quot;Ukranian&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p><img src="assets/imgs/wordshift2.png" alt="Word Shift" /></p>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h5 id="Analysis-of-word-shifts-for-Russian-and-Ukranian">Analysis of word shifts for Russian and Ukranian<a
          class="anchor-link" href="#Analysis-of-word-shifts-for-Russian-and-Ukranian">&#182;</a></h5>
      <p>To clarify what can be seen in the plot, the light colors represent the words that have been less frequently
        used in ukranian tweets than in russian tweets and the dark colors respresent words that are more frequently
        used in ukranian than in russian.</p>
      <p>Yellow indicates positive words, while blue indicates negative words.</p>
      <p>As can be seen by the light yellow color, the word 'russia' is not as commonly used by tweets written in
        ukranian, than they are in russian tweets. It can also be seen that it is counted as a positive word. Since the
        intention of the tweet is not necessarily for 'russia' to be positive, this might skew the overall result of the
        wordshift so that the overall ukranian tweets are counted more negatively than they perhaps should have been.
      </p>
      <p>To fix this issue, we would either have to have some contextual information and assign 'russia' and 'russian'
        our own sentiment score depending on the context or we would have to remove the word completely. Both of these
        seemed to be subpar solutions, since the decrease in the use of 'russia' and 'russian' is still a valuable
        insight and creating a context specific sentiment score for only the words 'russian' and 'russia' would make the
        wordshift unnecessarily complicated.</p>
      <p>It can be seen that ukrainian tweets more often include the word 'glory'. Ukrain has a war slogan 'Slava
        Ukraini' which translates to 'Glory to Ukraine' in english. 'win','victory' and 'enemy' is also more frequently
        used by ukrainian tweets.</p>
      <p>Russian tweets more often use the negative words 'bomb', 'operation', 'killed', 'attacked' than ukrainian
        tweets do. They also more often use the positive words like 'russia', 'russian', 'like', 'special', where, as
        previously stated the 'russia' and 'russian' is slightly more ambiguous in terms of what the sentiment score
        should be.</p>
      <p>Overall ukrainian tweets have a higher sentiment score than russian tweets, although the shift in sentiment
        score is not large.</p>

    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># this allows you to pull the scores from the shift graph (because we made ours in html)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sentiment_shift</span><span class="o">.</span><span class="n">get_shift_scores</span><span class="p">()[</span><span class="s1">&#39;world&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">sentiment_shift</span><span class="o">.</span><span class="n">get_shift_component_sums</span><span class="p">())</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h5 id="First-Two-Weeks-vs-Last-Two-Weeks-Wordshift">First Two Weeks vs Last Two Weeks Wordshift<a
          class="anchor-link" href="#First-Two-Weeks-vs-Last-Two-Weeks-Wordshift">&#182;</a></h5>
    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <ul>
        <li>We start out by building two lists $l_{bef}$ and $l_{aft}$. These lists contain all the tokens for tweets
          posted during the first two weeks and the last two weeks respectively.</li>
        <li>For each token $i$ we compute the relative frequency in the two lists $l_{bef}$ and $l_{aft}$. These are
          saved in the script as variables called p_bef and p_aft. In order to compute the relative frequency, we
          compute the number of times a token occurs over the total length of the document (the document is in this case
          all of the tokenized tweet text for the given time period). </li>
        <li>Then for each of the tokens, the happiness $h(i) = labMT(i) - 5$ is computed. We subtract 5 because we want
          the positive tokens to have a positive value, while the negative tokens gets a negative value. We use the
          labMT dictionary in order to compute the happiness scores for each token. Lastly we compute $\delta \Phi =
          h(i)\cdot \delta p(i)$. This is stored as the dictionary called dp</li>
      </ul>

    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># min date range is the first 14 days of the war</span>
<span class="n">min_date_range</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">data_df</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">periods</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span><span class="o">.</span><span class="n">date</span>
<span class="c1"># min date range is the last 14 days of the data</span>
<span class="n">max_date_range</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">data_df</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">periods</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span><span class="o">.</span><span class="n">date</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">min_date_df</span> <span class="o">=</span> <span class="n">data_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_df</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">min_date_range</span><span class="p">)]</span>
<span class="n">max_date_df</span> <span class="o">=</span> <span class="n">data_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_df</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">max_date_range</span><span class="p">)]</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1">#explode text columns to only have a single word per row instead of list </span>
<span class="n">l_bef</span> <span class="o">=</span> <span class="n">min_date_df</span><span class="o">.</span><span class="n">tokenized_text</span><span class="o">.</span><span class="n">explode</span><span class="p">()</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<span class="n">l_aft</span> <span class="o">=</span> <span class="n">max_date_df</span><span class="o">.</span><span class="n">tokenized_text</span><span class="o">.</span><span class="n">explode</span><span class="p">()</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">p_bef</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">l_bef</span><span class="p">))</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="n">Counter</span><span class="p">(</span><span class="n">l_bef</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
<span class="n">p_aft</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">l_aft</span><span class="p">))</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="n">Counter</span><span class="p">(</span><span class="n">l_aft</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>

<span class="n">all_tokens</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">p_bef</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">p_aft</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<span class="n">dp</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">token</span><span class="p">,</span><span class="n">p_bef</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">token</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">p_aft</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">token</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">all_tokens</span><span class="p">])</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="nb">sorted</span><span class="p">(</span><span class="n">dp</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span><span class="n">key</span><span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">token</span><span class="p">,</span><span class="n">lab_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">token</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">all_tokens</span><span class="p">])</span>
<span class="n">dPhi</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">token</span><span class="p">,</span> <span class="n">h</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="o">*</span> <span class="n">dp</span><span class="p">[</span><span class="n">token</span><span class="p">])</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">all_tokens</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">token</span><span class="p">])])</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="nb">sorted</span><span class="p">(</span><span class="n">dPhi</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span><span class="n">key</span><span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:</span><span class="mi">11</span><span class="p">]</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">sentiment_shift</span> <span class="o">=</span> <span class="n">sh</span><span class="o">.</span><span class="n">WeightedAvgShift</span><span class="p">(</span><span class="n">type2freq_1</span> <span class="o">=</span> <span class="n">p_bef</span><span class="p">,</span>
                     <span class="n">type2freq_2</span> <span class="o">=</span> <span class="n">p_aft</span><span class="p">,</span>
                       <span class="n">type2score_1</span> <span class="o">=</span> <span class="n">lab_dict</span><span class="p">,</span>
                   <span class="n">reference_value</span> <span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">sentiment_shift</span><span class="o">.</span><span class="n">get_shift_graph</span><span class="p">(</span><span class="n">detailed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">system_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;First Two Weeks&quot;</span><span class="p">,</span><span class="s2">&quot;Last Two Weeks&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;wordshift_time.png&#39;</span><span class="p">)</span>  
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p><img src="assets/imgs/wordshift1.png" alt="Word Shift" /></p>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h4 id="Analysis-of-Time-Wordshifts">Analysis of Time Wordshifts<a class="anchor-link"
          href="#Analysis-of-Time-Wordshifts">&#182;</a></h4>
      <p>To clarify what can be seen in the plot, the light colors represent the words that have been less frequently
        used in the last two weeks than in the first two weeks and the dark colors respresent words that are more
        frequently used in the last two weeks than in the first two weeks.</p>
      <p>Yellow indicates positive words, while blue indicates negative words.</p>
      <p>As can be seen by the light blue color, the words 'crimes', 'rape' and 'raped' was more frequently used in the
        first two weeks. However, the words 'stop', 'refugees', 'nuclear' and 'hospital' are more frequently used now.
        This might be because there is a larger amount of refugees now than there was in the first two weeks of the war
        and the topic of nuclear war and nuclear explosions are more prevalent now ever since the attack near Chernobyl.
      </p>
      <p>The word 'plant' is more frequently used now, but it is not easy to determine if this is referring to crops or
        nuclear power plants without more context.</p>
      <p>There is a slightly higher overall sentiment in these previous two weeks of data than in the first two weeks.
        However, this difference is very slight - only 0.01 shift in sentiment score.</p>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">

    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># this allows you to pull the scores from the shift graph (because we made ours in html)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sentiment_shift</span><span class="o">.</span><span class="n">get_shift_scores</span><span class="p">()[</span><span class="s1">&#39;crimes&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">sentiment_shift</span><span class="o">.</span><span class="n">get_shift_component_sums</span><span class="p">())</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h4 id="Word-clouds-using-TF-IDF-scores">Word clouds using TF-IDF scores<a class="anchor-link"
          href="#Word-clouds-using-TF-IDF-scores">&#182;</a></h4>
      <p>We constructed several word clouds filtered on time and language, respectively, in order to display and
        highlight relevant words in debate on Twitter. The word clouds were generated based on TF-IDF scores in order to
        highlight, not simply the most frequent used words, but the most relevant words for the specific language or
        time period.</p>
      <p>The term frequency (TF) is computed using the following formular:
        $$
        \large \mathrm{TF}=\frac{\text { count of } \mathrm{t} \text { in } \mathrm{d}}{\text { total number of words in
        } \mathrm{d}}
        $$
        where t is the term and d denotes the document.</p>
      <p>The IDF formula is as follows:
        $$
        \large \mathrm{IDF}=\log \left(\frac{\mathrm{N}}{\mathrm{df}+1}\right)
        $$
        where N is the total number of documents, df is the document frequency (number of documents in which term t
        occurs) and 1 is the shrink term.</p>
      <p>Usually it is smart to add a shrink term to the denominator (+1 for example) to avoid division by zero.</p>
      <p>However, in our case we are certain that all terms is present at least once in one of the documents and
        therefore we can omit the shrink term (which in return ensures no negative IDF values). Our final IDF formula
        used in the assignment is therefore the following:</p>
      $$
      \large \mathrm{IDF}=\log \left(\frac{\mathrm{N}}{\mathrm{df}}\right)
      $$<p>Three word clouds were constructed filtered on language; English, Ukranian and Russian.
        In the same way, three word clouds were constructed filtered on time in the periods; 21st Feb 2022 - 10th March
        2022, 11th March 2022 - 29th March 2022 and 30th March 2022 - 15th April 2022.</p>
      <p>In the sections below, the code used for wordcloud generation can be seen. It should be noted that a random
        subsample of 50.000 data points were used to generate the wordclouds, as it was infeasible in terms of
        computation time to use all of the 1 million data points. This does of course mean that the corpus only
        represents a subset of 5% of the original which will most likely have an effect on the IDF scores especially.
        However, we assume that this is still a representative cross section of the data for the purpose of this
        specific part of the analysis.</p>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h4 id="Wordclouds-filtered-on-language:-English,-Ukranian-and-Russian">Wordclouds filtered on language: English,
        Ukranian and Russian<a class="anchor-link"
          href="#Wordclouds-filtered-on-language:-English,-Ukranian-and-Russian">&#182;</a></h4>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># load all data</span>
<span class="n">clean_text</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;/work/data/ALL_CLEAN_TWEETS.csv&quot;</span><span class="p">,</span><span class="n">converters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;tokenized_text&#39;</span><span class="p">:</span> <span class="nb">eval</span><span class="p">,</span><span class="s1">&#39;tokenized_text_stemmed&#39;</span><span class="p">:</span> <span class="nb">eval</span><span class="p">,</span><span class="s2">&quot;translated_hashtags&quot;</span><span class="p">:</span> <span class="nb">eval</span> <span class="p">},</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># subsample 50.000 data points randomly</span>
<span class="n">clean_text</span> <span class="o">=</span> <span class="n">clean_text</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">50000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">all_lang</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;en&#39;</span><span class="p">,</span> <span class="s1">&#39;pt&#39;</span><span class="p">,</span> <span class="s1">&#39;ru&#39;</span><span class="p">,</span> <span class="s1">&#39;ja&#39;</span><span class="p">,</span> <span class="s1">&#39;es&#39;</span><span class="p">,</span> <span class="s1">&#39;ca&#39;</span><span class="p">,</span> <span class="s1">&#39;de&#39;</span><span class="p">,</span> <span class="s1">&#39;fr&#39;</span><span class="p">,</span> <span class="s1">&#39;th&#39;</span><span class="p">,</span> <span class="s1">&#39;fi&#39;</span><span class="p">,</span> <span class="s1">&#39;uk&#39;</span><span class="p">,</span>
       <span class="s1">&#39;et&#39;</span><span class="p">,</span> <span class="s1">&#39;it&#39;</span><span class="p">,</span> <span class="s1">&#39;tr&#39;</span><span class="p">,</span> <span class="s1">&#39;und&#39;</span><span class="p">,</span> <span class="s1">&#39;pl&#39;</span><span class="p">,</span> <span class="s1">&#39;zh&#39;</span><span class="p">,</span> <span class="s1">&#39;nl&#39;</span><span class="p">,</span> <span class="s1">&#39;cs&#39;</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="s1">&#39;hi&#39;</span><span class="p">,</span>
       <span class="s1">&#39;el&#39;</span><span class="p">,</span> <span class="s1">&#39;ht&#39;</span><span class="p">,</span> <span class="s1">&#39;fa&#39;</span><span class="p">,</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="s1">&#39;tl&#39;</span><span class="p">,</span> <span class="s1">&#39;ta&#39;</span><span class="p">,</span> <span class="s1">&#39;da&#39;</span><span class="p">,</span> <span class="s1">&#39;ar&#39;</span><span class="p">,</span> <span class="s1">&#39;sv&#39;</span><span class="p">,</span> <span class="s1">&#39;sr&#39;</span><span class="p">,</span> <span class="s1">&#39;sl&#39;</span><span class="p">,</span>
       <span class="s1">&#39;lv&#39;</span><span class="p">]</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># function to create large documents of all words within one category (language or time period)</span>

<span class="k">def</span> <span class="nf">large_document</span><span class="p">(</span><span class="n">lang</span><span class="p">):</span>
    <span class="n">lang_list</span> <span class="o">=</span> <span class="n">clean_text</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">clean_text</span><span class="p">[</span><span class="s1">&#39;language&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">lang</span><span class="p">]</span><span class="o">.</span><span class="n">tokenized_text</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">lang_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">lang_list</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">lang_list</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># function to compute TF scores</span>
<span class="k">def</span> <span class="nf">computeTF</span><span class="p">(</span><span class="n">doc</span><span class="p">):</span>
    <span class="n">TF_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">key</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">value</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">),</span><span class="mi">6</span><span class="p">))</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="n">Counter</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
    <span class="k">return</span> <span class="n">TF_dict</span>    
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># create large documents for all 32 languages</span>
<span class="k">for</span> <span class="n">lang</span> <span class="ow">in</span> <span class="n">all_lang</span><span class="p">:</span>
    <span class="nb">globals</span><span class="p">()</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">lang</span><span class="si">}</span><span class="s1">_doc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">large_document</span><span class="p">(</span><span class="n">lang</span><span class="p">)</span>

<span class="n">all_docs</span> <span class="o">=</span> <span class="p">[</span><span class="n">en_doc</span><span class="p">,</span> <span class="n">pt_doc</span><span class="p">,</span> <span class="n">ru_doc</span><span class="p">,</span> <span class="n">ja_doc</span><span class="p">,</span> <span class="n">es_doc</span><span class="p">,</span> <span class="n">ca_doc</span><span class="p">,</span> <span class="n">de_doc</span><span class="p">,</span> <span class="n">fr_doc</span><span class="p">,</span> <span class="n">th_doc</span><span class="p">,</span> <span class="n">fi_doc</span><span class="p">,</span> <span class="n">uk_doc</span><span class="p">,</span>
       <span class="n">et_doc</span><span class="p">,</span> <span class="n">it_doc</span><span class="p">,</span> <span class="n">tr_doc</span><span class="p">,</span> <span class="n">und_doc</span><span class="p">,</span> <span class="n">pl_doc</span><span class="p">,</span> <span class="n">zh_doc</span><span class="p">,</span> <span class="n">nl_doc</span><span class="p">,</span> <span class="n">cs_doc</span><span class="p">,</span> <span class="n">ro_doc</span><span class="p">,</span> <span class="n">no_doc</span><span class="p">,</span> <span class="n">hi_doc</span><span class="p">,</span>
       <span class="n">el_doc</span><span class="p">,</span> <span class="n">ht_doc</span><span class="p">,</span> <span class="n">fa_doc</span><span class="p">,</span> <span class="n">in_doc</span><span class="p">,</span> <span class="n">tl_doc</span><span class="p">,</span> <span class="n">ta_doc</span><span class="p">,</span> <span class="n">da_doc</span><span class="p">,</span> <span class="n">ar_doc</span><span class="p">,</span> <span class="n">sv_doc</span><span class="p">,</span> <span class="n">sr_doc</span><span class="p">,</span> <span class="n">sl_doc</span><span class="p">,</span>
       <span class="n">lv_doc</span><span class="p">]</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># compute TFs for all large documents</span>
<span class="k">for</span> <span class="n">doc</span><span class="p">,</span> <span class="n">lang</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">all_docs</span><span class="p">,</span> <span class="n">all_lang</span><span class="p">):</span>
    <span class="nb">globals</span><span class="p">()</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">lang</span><span class="si">}</span><span class="s1">_TF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">computeTF</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

<span class="n">all_TF</span> <span class="o">=</span> <span class="p">[</span><span class="n">en_TF</span><span class="p">,</span> <span class="n">pt_TF</span><span class="p">,</span> <span class="n">ru_TF</span><span class="p">,</span> <span class="n">ja_TF</span><span class="p">,</span> <span class="n">es_TF</span><span class="p">,</span> <span class="n">ca_TF</span><span class="p">,</span> <span class="n">de_TF</span><span class="p">,</span> <span class="n">fr_TF</span><span class="p">,</span> <span class="n">th_TF</span><span class="p">,</span> <span class="n">fi_TF</span><span class="p">,</span> <span class="n">uk_TF</span><span class="p">,</span>
       <span class="n">et_TF</span><span class="p">,</span> <span class="n">it_TF</span><span class="p">,</span> <span class="n">tr_TF</span><span class="p">,</span> <span class="n">und_TF</span><span class="p">,</span> <span class="n">pl_TF</span><span class="p">,</span> <span class="n">zh_TF</span><span class="p">,</span> <span class="n">nl_TF</span><span class="p">,</span> <span class="n">cs_TF</span><span class="p">,</span> <span class="n">ro_TF</span><span class="p">,</span> <span class="n">no_TF</span><span class="p">,</span> <span class="n">hi_TF</span><span class="p">,</span>
       <span class="n">el_TF</span><span class="p">,</span> <span class="n">ht_TF</span><span class="p">,</span> <span class="n">fa_TF</span><span class="p">,</span> <span class="n">in_TF</span><span class="p">,</span> <span class="n">tl_TF</span><span class="p">,</span> <span class="n">ta_TF</span><span class="p">,</span> <span class="n">da_TF</span><span class="p">,</span> <span class="n">ar_TF</span><span class="p">,</span> <span class="n">sv_TF</span><span class="p">,</span> <span class="n">sr_TF</span><span class="p">,</span> <span class="n">sl_TF</span><span class="p">,</span>
       <span class="n">lv_TF</span><span class="p">]</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># Create corpora including the 32 large documents</span>
<span class="n">corpora</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">lang</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_docs</span><span class="p">)):</span>
    <span class="n">corpora</span><span class="p">[</span><span class="n">lang</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_docs</span><span class="p">[</span><span class="n">lang</span><span class="p">]</span>

<span class="n">corpora_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">corpora</span><span class="p">)):</span>
    <span class="n">corpora_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">corpora</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="n">corpora_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">term</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">corpora_list</span> <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">])</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># compute IDF scores for all words in corpus</span>
<span class="n">IDFs</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">corpora</span><span class="p">)</span>
<span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">corpora_set</span><span class="p">):</span>
    <span class="c1"># compute document frequency for each term:</span>
    <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">corpora</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">term</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">corpora</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
            <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1"># Compute IDF for term</span>
    <span class="c1">#print(term)</span>
    <span class="n">IDFs</span><span class="p">[</span><span class="n">term</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">N</span> <span class="o">/</span> <span class="n">counter</span><span class="p">)</span>
     
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># Create function for computing TF-IDF values</span>
<span class="k">def</span> <span class="nf">computeTF_IDF</span><span class="p">(</span><span class="n">TF_dict</span><span class="p">,</span> <span class="n">IDF_dict</span><span class="p">):</span>
    <span class="n">tfidf_dict_lang</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">TF_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">tf</span> <span class="o">=</span> <span class="n">val</span>
        <span class="n">idf</span> <span class="o">=</span> <span class="n">IDF_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="n">tfidf_dict_lang</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">tf</span><span class="o">*</span><span class="n">idf</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">tfidf_dict_lang</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># compute TF-IDF scores for all languages</span>
<span class="k">for</span> <span class="n">lang</span><span class="p">,</span> <span class="n">tf</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">all_lang</span><span class="p">,</span> <span class="n">all_TF</span><span class="p">):</span>
    <span class="nb">globals</span><span class="p">()</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">lang</span><span class="si">}</span><span class="s1">_tf_idf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">computeTF_IDF</span><span class="p">(</span><span class="n">tf</span><span class="p">,</span> <span class="n">IDFs</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># function for generating wordcloud</span>
<span class="k">def</span> <span class="nf">generate_wordcloud</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">cloud</span> <span class="o">=</span> <span class="n">WordCloud</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                      <span class="n">max_words</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
                      <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;twilight&#39;</span><span class="p">,</span>
                      <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span>
                      <span class="n">background_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>
                      <span class="p">)</span><span class="o">.</span><span class="n">generate_from_frequencies</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cloud</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># English wordcloud</span>
<span class="n">en_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;masks/world_mask.png&#39;</span><span class="p">))</span>
<span class="n">wordcloud_en</span> <span class="o">=</span> <span class="n">generate_wordcloud</span><span class="p">(</span><span class="n">en_tf_idf</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">en_mask</span><span class="p">)</span>
<span class="n">wordcloud_en</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s2">&quot;english_wc.png&quot;</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p><img src="assets/imgs/wordclouds/english_wc.png" alt="Drawing" /></p>

    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># Russian wordcloud</span>
<span class="n">ru_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;masks/ru_mask.png&#39;</span><span class="p">))</span>
<span class="n">wordcloud_ru</span> <span class="o">=</span> <span class="n">generate_wordcloud</span><span class="p">(</span><span class="n">ru_tf_idf</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">ru_mask</span><span class="p">)</span>
<span class="n">wordcloud_ru</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s2">&quot;russian_wc.png&quot;</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p><img src="assets/imgs/wordclouds/russian_wc.png" alt="Drawing" /></p>

    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># Ukranian wordcloud</span>
<span class="n">uk_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;masks/ukr_mask.png&#39;</span><span class="p">))</span>
<span class="n">wordcloud_uk</span> <span class="o">=</span> <span class="n">generate_wordcloud</span><span class="p">(</span><span class="n">uk_tf_idf</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">uk_mask</span><span class="p">)</span>
<span class="n">wordcloud_uk</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s2">&quot;ukranian_wc.png&quot;</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p><img src="assets/imgs/wordclouds/ukranian_wc.png" alt="Drawing" /></p>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h4 id="Analysis-of-language-wordclouds">Analysis of language wordclouds<a class="anchor-link"
          href="#Analysis-of-language-wordclouds">&#182;</a></h4>
      <h5 id="English">English<a class="anchor-link" href="#English">&#182;</a></h5>
      <p>Looking at the English wordcloud we can get a sense of what words/subjects are discussed in general all over
        the
        world, as English is the language most often used to communicate between different nationalities.
        Some of the most prominent words are "russia(n)", "ukraine(ian)", "zelensky", "putin", "biden" and "trump",
        which are all very general in terms of the war. In other words the presence of these words could indicate that
        the political situation and factual development of the war is what is discussed the most across nationalities.
        This seems sensible as this is the ways in which most countries are affected by the war and therefore this is
        probably what is interesting to most people worldwide. Other words which represent more specific subjects
        include "gas", "oligarchs", "nato", "oil", "fight", "support" and "kyiv". This is most likely representing the
        consequences of the western sanctions towards Russia which have caused a shortage of gas and oil supply as well
        as price increases. Also it is highly debated to what extend NATO should help Ukraine and the presence of this
        word could indicate that people are expressing their opinion about this matter online. Lastly words like
        "please", "fight" and "kyiv" are included in the wordcloud. We cannot conclude anything regarding who is
        fighting for/supporting who based on these stand-alone words. However, the presence of the word "kyiv" indicates
        that a majority of the users expressing themselves in English are supporting Ukraine, as the choice of spelling
        Kyiv in the Ukrainian way has become a symbol of supporting the country during the war.</p>
      <h5 id="Russian">Russian<a class="anchor-link" href="#Russian">&#182;</a></h5>
      <p>Looking at the Russian wordcloud, many of the words from the English wordclouds such as "ukraine(ian)",
        "russia(n)", "zelensky" and "putin" recur in here. However, some distinct words are present as well. These
        include "terrorist", "operation", "oppression", "belarus", "access", "sanctions" and many more. Once again it is
        hard to say anything certain about the dicourse and opinions towards these subjects based on single words but we
        can infer that subjects such as the development in the invasion of Ukraine and the effects of the sanctions
        towards their country are some of the focuses of the Russians.</p>
      <h5 id="Ukranian">Ukranian<a class="anchor-link" href="#Ukranian">&#182;</a></h5>
      <p>One of the most distinctive and informative wordclouds in terms of sentiment and discourse are the Ukrainian.
        Here we see (probably) hashtags such as "stoprussia" and "standwithukraine" which of course expresses sympathy
        with their country. Words such as "children" and "feminism" may refer to the war crimes committed by Russia such
        as killing civilians (including targetting schools and kinder gardens) and rape of the women, and words like
        "freedom", "please" and "world" may symbolise the Ukranians' cry and hope for help from the rest of the world.
        It should be emphaised that this is just suggestions and we cannot conclude anything confidently about the
        meanings behind the wordclouds based entirely on singe words.</p>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h4 id="Wordclouds-filtered-on-time-period:-21/2-10/3,-11/3-29/3-and-30/3-15/4">Wordclouds filtered on time
        period: 21/2-10/3, 11/3-29/3 and 30/3-15/4<a class="anchor-link"
          href="#Wordclouds-filtered-on-time-period:-21/2-10/3,-11/3-29/3-and-30/3-15/4">&#182;</a></h4>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">clean_text_test</span> <span class="o">=</span> <span class="n">clean_text</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">clean_text_test</span><span class="p">[</span><span class="s1">&#39;date_created&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">clean_text_test</span><span class="p">[</span><span class="s1">&#39;created_utc&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="n">clean_text_test</span> <span class="o">=</span> <span class="n">clean_text_test</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;date_created&quot;</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1">#dataframe including first time period</span>
<span class="n">start_date1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s1">&#39;2022-02-21 00:00:00+0000&#39;</span><span class="p">)</span>
<span class="n">end_date1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s1">&#39;2022-03-10 00:00:00+0000&#39;</span><span class="p">)</span>
<span class="n">mask1</span> <span class="o">=</span> <span class="p">(</span><span class="n">clean_text_test</span><span class="p">[</span><span class="s1">&#39;date_created&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">start_date1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">clean_text_test</span><span class="p">[</span><span class="s1">&#39;date_created&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">end_date1</span><span class="p">)</span>

<span class="n">clean_text1</span> <span class="o">=</span> <span class="n">clean_text_test</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask1</span><span class="p">]</span>

<span class="c1">#dataframe including second time period</span>
<span class="n">start_date2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s1">&#39;2022-03-11 00:00:00+0000&#39;</span><span class="p">)</span>
<span class="n">end_date2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s1">&#39;2022-03-29 00:00:00+0000&#39;</span><span class="p">)</span>
<span class="n">mask2</span> <span class="o">=</span> <span class="p">(</span><span class="n">clean_text_test</span><span class="p">[</span><span class="s1">&#39;date_created&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">start_date2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">clean_text_test</span><span class="p">[</span><span class="s1">&#39;date_created&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">end_date2</span><span class="p">)</span>

<span class="n">clean_text2</span> <span class="o">=</span> <span class="n">clean_text_test</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask2</span><span class="p">]</span>

<span class="c1">#dataframe including third time period</span>
<span class="n">start_date3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s1">&#39;2022-03-30 00:00:00+0000&#39;</span><span class="p">)</span>
<span class="n">end_date3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s1">&#39;2022-04-15 00:00:00+0000&#39;</span><span class="p">)</span>
<span class="n">mask3</span> <span class="o">=</span> <span class="p">(</span><span class="n">clean_text_test</span><span class="p">[</span><span class="s1">&#39;date_created&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">start_date3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">clean_text_test</span><span class="p">[</span><span class="s1">&#39;date_created&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">end_date3</span><span class="p">)</span>

<span class="n">clean_text3</span> <span class="o">=</span> <span class="n">clean_text_test</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask3</span><span class="p">]</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># create large doc for all dates</span>
<span class="n">time_large_doc1</span> <span class="o">=</span> <span class="n">clean_text1</span><span class="o">.</span><span class="n">tokenized_text</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">time_large_doc1</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">time_large_doc1</span><span class="p">))</span>

<span class="n">time_large_doc2</span> <span class="o">=</span> <span class="n">clean_text2</span><span class="o">.</span><span class="n">tokenized_text</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">time_large_doc2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">time_large_doc2</span><span class="p">))</span>

<span class="n">time_large_doc3</span> <span class="o">=</span> <span class="n">clean_text3</span><span class="o">.</span><span class="n">tokenized_text</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">time_large_doc3</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">time_large_doc3</span><span class="p">))</span>

<span class="n">all_docs_time</span> <span class="o">=</span> <span class="p">[</span><span class="n">time_large_doc1</span><span class="p">,</span> <span class="n">time_large_doc2</span><span class="p">,</span> <span class="n">time_large_doc3</span><span class="p">]</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># compute TF</span>
<span class="n">time_tf1</span> <span class="o">=</span> <span class="n">computeTF</span><span class="p">(</span><span class="n">time_large_doc1</span><span class="p">)</span>
<span class="n">time_tf2</span> <span class="o">=</span> <span class="n">computeTF</span><span class="p">(</span><span class="n">time_large_doc2</span><span class="p">)</span>
<span class="n">time_tf3</span> <span class="o">=</span> <span class="n">computeTF</span><span class="p">(</span><span class="n">time_large_doc3</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># Create corpora including the 32 large documents</span>

<span class="n">corpora_time</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">period</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">corpora_time</span><span class="p">[</span><span class="n">period</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_docs_time</span><span class="p">[</span><span class="n">period</span><span class="p">]</span>

<span class="n">corpora_list_time</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">corpora_time</span><span class="p">)):</span>
    <span class="n">corpora_list_time</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">corpora_time</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="n">corpora_set_time</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">term</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">corpora_list_time</span> <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">])</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">IDFs_time</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">corpora_time</span><span class="p">)</span>
<span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">corpora_set_time</span><span class="p">):</span>
    <span class="c1"># compute document frequency for each term:</span>
    <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">corpora_time</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">term</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">corpora_time</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
            <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1"># Compute IDF for term</span>
    <span class="n">IDFs_time</span><span class="p">[</span><span class="n">term</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">N</span> <span class="o">/</span> <span class="n">counter</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">tf_idf1</span> <span class="o">=</span> <span class="n">computeTF_IDF</span><span class="p">(</span><span class="n">time_tf1</span><span class="p">,</span> <span class="n">IDFs_time</span><span class="p">)</span>
<span class="n">tf_idf2</span> <span class="o">=</span> <span class="n">computeTF_IDF</span><span class="p">(</span><span class="n">time_tf2</span><span class="p">,</span> <span class="n">IDFs_time</span><span class="p">)</span>
<span class="n">tf_idf3</span> <span class="o">=</span> <span class="n">computeTF_IDF</span><span class="p">(</span><span class="n">time_tf3</span><span class="p">,</span> <span class="n">IDFs_time</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># 21/2 - 10/3 wordcloud</span>
<span class="n">wordcloud_period1</span> <span class="o">=</span> <span class="n">generate_wordcloud</span><span class="p">(</span><span class="n">tf_idf1</span><span class="p">)</span>
<span class="n">wordcloud_period1</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s2">&quot;21_02_to_10_03_wc.png&quot;</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p><img src="assets/imgs/wordclouds/21_02_to_10_03_wc.png" alt="Drawing" /></p>

    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># 11/3 - 29/3 wordcloud</span>
<span class="n">wordcloud_period2</span> <span class="o">=</span> <span class="n">generate_wordcloud</span><span class="p">(</span><span class="n">tf_idf2</span><span class="p">)</span>
<span class="n">wordcloud_period2</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s2">&quot;11_03_to_29_03_wc.png&quot;</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p><img src="assets/imgs/wordclouds/11_03_to_29_03_wc.png" alt="Drawing" /></p>

    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># 30/3 - 15/4 wordcloud</span>
<span class="n">wordcloud_period3</span> <span class="o">=</span> <span class="n">generate_wordcloud</span><span class="p">(</span><span class="n">tf_idf3</span><span class="p">)</span>
<span class="n">wordcloud_period3</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s2">&quot;30_03_to_15_04_wc.png&quot;</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p><img src="assets/wordclouds/30_03_to_15_04_wc.png" alt="Drawing" /></p>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h4 id="Analysis-of-time-period-wordclouds">Analysis of time period wordclouds<a class="anchor-link"
          href="#Analysis-of-time-period-wordclouds">&#182;</a></h4>
      <p>Looking at the wordclouds based on relevant words for different time periods, we hoped to see a change of
        discourse and/or subject as time proceeded. Looking at the first period of the war spanning from the Russian
        Invasion of Ukraine until March 10th, we see that some of the most prominent words are "williamson", "edinburgh"
        and "absolutist". The first refer to Hugh Williamson, the Europe and Central Asia director at Human Rights
        Watch, who in the first days of the war expressed deep concerns towards Russia's act of war crimes <a
          href="https://www.hrw.org/news/2022/04/03/ukraine-apparent-war-crimes-russia-controlled-areas">(www.hrw.org)</a>
        and the term "edinburgh" may be rated as relevant because Ukranians joined in huge demonstrations in Scotland
        against the attacks on their homelands during the first days of the war <a
          href="https://www.bbc.com/news/uk-scotland-60521038">(www.bbc.com)</a>. "Absolutist" can refer to different
        specific cases or simply the meaning of the term itself. One specific case which was trending on March 7th was
        when Elon Musk refused to block Russian news sources, which resulted in many people accusing him of being a
        "free speech absolutist" <a
          href="https://economictimes.indiatimes.com/magazines/panache/ukraine-crisis-elon-musk-refuses-blocking-russian-news-sources-says-hes-a-free-speech-absolutist/articleshow/90013351.cms">(www.economictimes.indiatimes.com)</a>.
      </p>
      <p>Turning our attention towards the second wordcloud from March 11th to March 29th, the some of the largest
        displayed words are "birzamanlar", "ibrahimcelikkol", "zulhak", "russianassettracker" (probably a hashtag) and
        "schwarzenegger". When investigating these words, we found that some words seemed more related to the war than
        others. For example "birzamanlar" and "ibrahimcelikkol" is a Turkish expression and actor, respectively, which
        do not have any obvious connection to the war. On the other hand the expression "russian-asset-tracker" is the
        name of a global investigation into assets held outside Russia linked to individuals sanctioned for supporting
        the government of Russia <a
          href="https://www.theguardian.com/world/series/russian-asset-tracker">(www.theguardian.com)</a> which were
        kicked off on April 8th 2022. Furthermore Arnold Schwarznegger held a speech on March 18th, where he publicly
        asked Putin to stop the war <a href="https://www.bbc.com/news/world-us-canada-60794809">(www.bbc.com)</a>.</p>
      <p>In the last wordcloud representing the period from March 30th until April 15th, it is very obvious to see that
        the focus of many tweets regarding the war is the rapid increase in war crimes performed by Russia. Words like
        burcha-massacre, rape and acid is in focus which most likely refers to killings and rapes in Bucha during the
        weeks of April <a
          href="https://kyivindependent.com/national/uncovering-the-scope-of-the-bucha-massacre/">(www.kyivindependent.com)</a>
        as well as the public suspense of whether Russia has used chemical weapons in Ukraine <a
          href="https://www.19fortyfive.com/2022/04/chemical-warfare-in-ukraine-russia-destroys-nitric-acid-tank/">(www.19fortyfive.com)</a>.
      </p>
      <p>All in all the wordclouds based on TF-IDF scores gives insights into the historical and political developments
        during the war, and more specifically the TF-IDF scores seems to catch the more specific stories and trends
        rather than the overall most frequently used words.</p>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h4 id="Most-Popular-Hashtags-Over-Time">Most Popular Hashtags Over Time<a class="anchor-link"
          href="#Most-Popular-Hashtags-Over-Time">&#182;</a></h4>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># we need the date and hashtags</span>
<span class="n">hashtag_df</span> <span class="o">=</span> <span class="n">data_df</span><span class="p">[[</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;translated_hashtags&#39;</span><span class="p">]]</span>
<span class="c1"># remove tweets without hashtags</span>
<span class="n">hashtag_df</span> <span class="o">=</span> <span class="n">hashtag_df</span><span class="p">[</span><span class="n">hashtag_df</span><span class="o">.</span><span class="n">translated_hashtags</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)]</span>
<span class="n">hashtag_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># we explode the dataframe to have single important words per row - this is because we want to find most frequently used hashtags</span>
<span class="n">hashtag_df</span> <span class="o">=</span> <span class="n">hashtag_df</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="s1">&#39;translated_hashtags&#39;</span><span class="p">)</span>
<span class="n">hashtag_value_counts</span> <span class="o">=</span> <span class="n">hashtag_df</span><span class="o">.</span><span class="n">translated_hashtags</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()[:</span><span class="mi">500</span><span class="p">]</span>

<span class="n">top_k_hashtags</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hashtag_value_counts</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">counts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hashtag_value_counts</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># remove undefined and y from hashtag list</span>
<span class="n">top_k_hashtags</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">top_k_hashtags</span><span class="p">)</span><span class="o">-</span><span class="nb">set</span><span class="p">([</span><span class="s1">&#39;und&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>

<span class="c1"># only use top k hashtags</span>
<span class="n">hashtag_df</span> <span class="o">=</span> <span class="n">hashtag_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hashtag_df</span><span class="o">.</span><span class="n">translated_hashtags</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">top_k_hashtags</span><span class="p">)]</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># we explode the dataframe to have single important words per row</span>
<span class="n">hashtag_df</span> <span class="o">=</span> <span class="n">hashtag_df</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="s1">&#39;translated_hashtags&#39;</span><span class="p">)</span>

<span class="c1"># group by date and hashtags and count how many per hashtag per day</span>
<span class="n">hashtag_df</span> <span class="o">=</span> <span class="n">hashtag_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;translated_hashtags&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">hashtag_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">hashtag_df</span> <span class="o">=</span> <span class="n">hashtag_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="c1"># melt the dataframe to only countain columns [&#39;date&#39;, &#39;name&#39;, &#39;category&#39;, &#39;value&#39;] (needed for js)</span>
<span class="n">hashtag_df</span> <span class="o">=</span> <span class="n">hashtag_df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">],</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">hashtag_df</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;hashtag&#39;</span>
<span class="n">hashtag_df</span> <span class="o">=</span> <span class="n">hashtag_df</span><span class="p">[[</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">]]</span>
<span class="n">hashtag_df</span> <span class="o">=</span> <span class="n">hashtag_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">)</span>
<span class="n">hashtag_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data_hashtags.csv&#39;</span><span class="p">)</span>
<span class="n">hashtag_df</span>

<span class="c1"># now save as csv file and copy over the data to file in d3js folder</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p><img src="assets/imgs/chartrace.png" alt="Word Shift" /></p>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p>The bar chart is originally an animation displayed on our webpage but it was only possible to illustrate a
        still-image here (due to the implementation in HTML). We therefore refer to our webpage to see the live
        animation.</p>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h5 id="Analyses-of-dynamic-bar-chart">Analyses of dynamic bar chart<a class="anchor-link"
          href="#Analyses-of-dynamic-bar-chart">&#182;</a></h5>
      <p>Looking at the bar chart from day to day, we see a general persistent trend in hashtags such as Ukraine and
        Russia. Furthermore many hashtags expressing sympathy with Ukraine is trending throughout the period. Examples
        of these are "StandWithUkraine" and "StopRussia".</p>
      <p>One of the very interesting things we find when studying the development in hashtag-trends is that different
        Ukranian city names are trending around the same day as their were attacked by Russia. This means that the bar
        chart provides us with a rather precise timeline of the attacks of Ukrainian cities. On the 24/02/2022 we see
        that "Kyiv" is trending which corresponds to the day that Russia initiated attacks on the Kyiv Oblast <a
          href="https://edition.cnn.com/europe/live-news/ukraine-russia-news-02-24-22-intl/index.html">(www.edition.cnn.com)</a>.
        The same applies on 02/03/2022 where Kharkiv was trending and the Russian army captured Kharkiv <a
          href="https://www.nytimes.com/live/2022/03/02/world/ukraine-russia-war">(www.nytimes.com)</a>, Mariupol on
        10/03/2022, where the city was bombed <a
          href="https://www.theguardian.com/world/2022/mar/10/mariupol-bombing-ukraine-before-and-after-satellite-images-map-russian-attack-residential-maternity-childrens-hospital">(www.theguardian.com)</a>
        and lastly "Bucha" and "Buchamassacre" on 04/04/2022 and the following days. Bucha was visited on 04/04 by
        Ukranian president Zelensky after the killings, rapings and torturement of many Ukranian civilians.</p>
      <p>All in all it seems that the majority, if not all, of the top trending hashtags on Twitter regarding the war
        expresses sympathy with Ukraine in this time of war. It is therefore probable that the majority of Twitter users
        sympathises with Ukraine. Still it cannot be excluded that some nations may use other social media platforms
        than Twitter and therefore we cannot conclude that the majority of social media users in general supports
        Ukraine.</p>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h3 id="Twitter-Networks">Twitter Networks<a class="anchor-link" href="#Twitter-Networks">&#182;</a></h3>
      <p>In the social network aspect part of this assignment, we will investigate Twitter network graphs based on the
        language of users and parent authors in Ukrainian and Russian. We will first examine to which degree users
        cluster together and how the network clusters compares to a null model. Then we will look even further into
        these clusters and investigate how communities in the graphs are formed and how strong they are - for this we
        will use modularity as measure as well as comparing the graphs with configuration models.</p>
      <p>Due to computational limitations, an in-depth analysis of the English Twitter network is not possible. If we
        were to use the whole dataset to create the English betwork, we would have around 500.000 nodes which is
        infeasible to work with. For the Ukrainian and Russian networks, all data points are used - there is 3.562 and
        10.339 data points respectively for the two groups. We tried sampling the English tweets (40.000 tweets), but
        decided that rather than drawing conlusions based on an analysis of a subset instead of the whole dataset, we
        would focus our attention on the two other language based networks.</p>

    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="k">as</span> <span class="nn">cm</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>

<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">import</span> <span class="nn">netwulf</span> <span class="k">as</span> <span class="nn">nw</span>
<span class="kn">from</span> <span class="nn">netwulf</span> <span class="kn">import</span> <span class="n">visualize</span>
<span class="kn">from</span> <span class="nn">pyvis.network</span> <span class="kn">import</span> <span class="n">Network</span>
<span class="kn">import</span> <span class="nn">community.community_louvain</span>

<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">combinations</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># loading all clean tweets</span>
<span class="n">all_tweets</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;/work/data/ALL_CLEAN_TWEETS.csv&quot;</span><span class="p">,</span><span class="n">converters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;tokenized_text&#39;</span><span class="p">:</span> <span class="nb">eval</span><span class="p">,</span><span class="s1">&#39;tokenized_text_stemmed&#39;</span><span class="p">:</span> <span class="nb">eval</span><span class="p">,</span><span class="s2">&quot;translated_hashtags&quot;</span><span class="p">:</span> <span class="nb">eval</span> <span class="p">},</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h4 id="Creating-the-graphs">Creating the graphs<a class="anchor-link" href="#Creating-the-graphs">&#182;</a></h4>
      <p>Unlike the GME graph, we will not build an reciprocal undirected graph from the weighted edgelists - this is
        because in the data collected, only tweets containing the keywords specified earlier are fetched, which limits
        us to get all replies to a single tweet. Furthermore, the Twitter API does not allow us to get all replies since
        this requires a Premium account. This means that there will not be connections that appear in both directions.
        This is something we should have considered in the beginning as limitation, but since a big part of Twitter is
        retweeting rather than actually replying (which would never result in connections in both directions), building
        non-reciprocal graphs may still be a good representation of the network.</p>

    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># get both directed and undirected versions of the network graphs</span>
<span class="k">def</span> <span class="nf">create_nx_graph</span><span class="p">(</span><span class="n">language</span><span class="p">,</span><span class="n">w_edgelist</span><span class="p">):</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">w_edgelist</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">G</span><span class="o">.</span><span class="n">add_weighted_edges_from</span><span class="p">([(</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">value</span><span class="p">)])</span> 
    <span class="n">H</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">to_undirected</span><span class="p">(</span><span class="n">reciprocal</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">H</span><span class="o">.</span><span class="n">remove_edges_from</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">selfloop_edges</span><span class="p">(</span><span class="n">H</span><span class="p">)))</span>
    <span class="n">H</span><span class="o">.</span><span class="n">remove_nodes_from</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">isolates</span><span class="p">(</span><span class="n">H</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">G</span><span class="p">,</span><span class="n">H</span>

<span class="k">def</span> <span class="nf">create_w_edgelist</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">language</span><span class="p">):</span>
    <span class="n">w_edgelist</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;language&quot;</span><span class="p">]</span><span class="o">==</span><span class="n">language</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;username&quot;</span><span class="p">,</span> <span class="s2">&quot;parent_author&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">w_edgelist</span> 
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># creating network graphs based on the Ukrainian and Russian discourse:</span>
<span class="n">w_edgelist_uk</span> <span class="o">=</span> <span class="n">create_w_edgelist</span><span class="p">(</span><span class="n">all_tweets</span><span class="p">,</span> <span class="s2">&quot;uk&quot;</span><span class="p">)</span>
<span class="n">G_uk</span><span class="p">,</span> <span class="n">H_uk</span> <span class="o">=</span> <span class="n">create_nx_graph</span><span class="p">(</span><span class="s2">&quot;uk&quot;</span><span class="p">,</span> <span class="n">w_edgelist_uk</span><span class="p">)</span>

<span class="n">w_edgelist_ru</span> <span class="o">=</span> <span class="n">create_w_edgelist</span><span class="p">(</span><span class="n">all_tweets</span><span class="p">,</span><span class="s2">&quot;ru&quot;</span><span class="p">)</span>
<span class="n">G_ru</span><span class="p">,</span> <span class="n">H_ru</span> <span class="o">=</span> <span class="n">create_nx_graph</span><span class="p">(</span><span class="s2">&quot;ru&quot;</span><span class="p">,</span> <span class="n">w_edgelist_ru</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p>This gives us the following three undirected networks:</p>
      <p><strong>Ukrainian Twitter Network:</strong></p>
      <ul>
        <li>Number of nodes: 3348</li>
        <li>Number of edges: 2930</li>
        <li>Average degree: 1.7503 </li>
      </ul>
      <p><strong>Russian Twitter Network:</strong></p>
      <ul>
        <li>Number of nodes: 8544</li>
        <li>Number of edges: 8132</li>
        <li>Average degree: 1.9036 </li>
      </ul>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h4 id="Random-Networks-as-Null-Models">Random Networks as Null Models<a class="anchor-link"
          href="#Random-Networks-as-Null-Models">&#182;</a></h4>
      <p>Now we will create Random Networks as null models to investigate some properties of the Twitter Networks.</p>
      <p>We will create random networks based on the <strong>R(N, p)</strong> model introduced by Edgar Nelson Gilbert:
        Each pair of <em>N</em> labeled nodes is connected with probability <em>p</em>. Computing N and p from the
        network we are investigating is done by the following:</p>
      <p>The formula for the for the expected number of edges in the random network is (given in <a
          href="http://networksciencebook.com/chapter/3#number-of-links">section 3.3 of the Network Science book </a>):
        $$
        \langle L\rangle=\sum_{L=0}^{\frac{N(N-1)}{2}} L p_{L}=p \frac{N(N-1)}{2}
        $$</p>
      <p>Setting $\langle L\rangle$ equal to the actual number of edges in the given network, the probabily p can be
        found by:
        $$
        p = \frac{\langle L\rangle}{\frac{N(N-1)}{2}}
        $$</p>

    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># using the formula above, the random network function is created:</span>

<span class="k">def</span> <span class="nf">create_random_network</span><span class="p">(</span><span class="n">H</span><span class="p">):</span>
    <span class="n">L_edges</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
    <span class="n">N_nodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">L_edges</span><span class="o">/</span><span class="p">(</span><span class="n">N_nodes</span> <span class="o">*</span> <span class="p">(</span><span class="n">N_nodes</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="n">R</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
    <span class="n">all_edge_combinations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">combinations</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">N_nodes</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
    
    <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">all_edge_combinations</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">p</span><span class="p">:</span>
            <span class="n">R</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="o">*</span><span class="n">edge</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">R</span>
    
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">R_uk</span> <span class="o">=</span> <span class="n">create_random_network</span><span class="p">(</span><span class="n">H_uk</span><span class="p">)</span>
<span class="n">R_ru</span> <span class="o">=</span> <span class="n">create_random_network</span><span class="p">(</span><span class="n">H_ru</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p>This gives us the following Random Networks:</p>
      <p><strong>Random Ukrainian Twitter Network:</strong></p>
      <ul>
        <li>Number of nodes: 2793</li>
        <li>Number of edges: 3020</li>
        <li>Average degree: 2.1625 </li>
      </ul>
      <p><strong>Random Russian Twitter Network:</strong></p>
      <ul>
        <li>Number of nodes: 7274</li>
        <li>Number of edges: 8135</li>
        <li>Average degree: 2.2367</li>
      </ul>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h5 id="Clustering:-Compare-clustering-trends-in-the-Networks-and-their-random-counterpart">Clustering: Compare
        clustering trends in the Networks and their random counterpart<a class="anchor-link"
          href="#Clustering:-Compare-clustering-trends-in-the-Networks-and-their-random-counterpart">&#182;</a></h5>
      <p>Using the random networks, we can investigate the clustering trends within the Ukrainian and Russian Twitter
        networks. Computing the <em>local clustering coefficient</em> of a particular node allows us to capture the
        relationship between the neighbors of that node and relates then to the density of the neighboorhood - the more
        densely connected neighboorhood surrounding the mode, the higher is the coefficient. The local clustering
        coefficient is given <a href="http://networksciencebook.com/chapter/2#connectedness">section 2.10 of the Network
          Science book</a> and is defined as:</p>
      $$
      C_{i}=\frac{2 L_{i}}{k_{i}\left(k_{i}-1\right)}
      $$<p>where $L_i$ is the number of links between the $k_i$ neighbors of node $i$.</p>
      <p>We can then use this formula to compute the <em>average clustering coefficient</em> of the whole network:
        $$
        \langle C\rangle=\frac{1}{N} \sum_{i=1}^{N} C_{i}
        $$</p>

    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># implementing the average clustering coefficient:</span>

<span class="k">def</span> <span class="nf">compute_cluster_coeff</span><span class="p">(</span><span class="n">G</span><span class="p">):</span>
    <span class="n">cluster_coefs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">()):</span>
        
        <span class="c1"># clustering coefficient is 0 if the node only has one neighbor (there are no singletons either)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">node</span><span class="p">)))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> 
            <span class="n">cluster_coefs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span> 
            <span class="n">L_i</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">neighbors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">combinations</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">node</span><span class="p">)),</span> <span class="mi">2</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">neighbors</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">G</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="o">*</span><span class="n">pair</span><span class="p">):</span>
                    <span class="n">L_i</span><span class="o">+=</span><span class="mi">1</span>

            <span class="n">k_i</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">degree</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="n">cluster_coefs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">L_i</span><span class="o">/</span><span class="p">(</span><span class="n">k_i</span><span class="o">*</span><span class="p">(</span><span class="n">k_i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mf">1e-5</span><span class="p">))</span> <span class="c1">#add small number to avoid division by zero</span>
            
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cluster_coefs</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">H_uk_cc</span> <span class="o">=</span> <span class="n">compute_cluster_coeff</span><span class="p">(</span><span class="n">H_uk</span><span class="p">)</span>
<span class="n">R_uk_cc</span> <span class="o">=</span> <span class="n">compute_cluster_coeff</span><span class="p">(</span><span class="n">R_uk</span><span class="p">)</span>

<span class="n">H_ru_cc</span> <span class="o">=</span> <span class="n">compute_cluster_coeff</span><span class="p">(</span><span class="n">H_ru</span><span class="p">)</span>
<span class="n">R_ru_cc</span> <span class="o">=</span> <span class="n">compute_cluster_coeff</span><span class="p">(</span><span class="n">R_ru</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p>Cluster coefficient for the Ukrainian Twitter Networks:</p>
      <ul>
        <li>Original network, H_uk: <strong>0.000158</strong></li>
        <li>Random network, R_uk: <strong>0.000442</strong></li>
      </ul>
      <p>Cluster coefficient for the Russian Twitter Networks:</p>
      <ul>
        <li>Original network, H_ru: <strong>0.000344</strong></li>
        <li>Random network, R_ru: <strong>0.00044</strong></li>
      </ul>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h5 id="Visualizing-the-Twitter-networks-and-their-random-counterpart">Visualizing the Twitter networks and their
        random counterpart<a class="anchor-link"
          href="#Visualizing-the-Twitter-networks-and-their-random-counterpart">&#182;</a></h5>
    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p><strong>Ukrainian: Original vs. Random Graph</strong></p>
      <table>
        <tr>
          <td> <img src="assets/imgs/network graphs/H_uk.png" style="width:400px"> </td>
          <td> <img src="assets/imgs/network graphs/R_uk.png" style="width:400px"> </td>
        </tr>
      </table>
    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p><strong>Russian: Original vs. Random Graph</strong></p>
      <table>
        <tr>
          <td> <img src="assets/imgs/network graphs/H_ru.png" style="width:400px"> </td>
          <td> <img src="assets/imgs/network graphs/R_ru.png" style="width:400px"> </td>
        </tr>
      </table>
    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p><strong>What do these findings tell us?</strong></p>
      <p>In compariring the Ukrainian and Russian cluster coefficients, we see that the Russian coefficent is a little
        over 2 times bigger than the Ukrainian. In the two networks, the distribution of original, replies and retweets
        are about 15%, 6% and 79% for Ukrainian tweets and 18%, 11% and 71% for Russian tweets, which could explain why
        the Russian clustering coefficent is higher than that of Ukraine - it seems that people reply to each other more
        often rather than retweeting in the Russian network. However we must of course be aware that Russian is also
        spoken in Ukraine (the language distribution is about 68% Ukrainian and 30% Russian according to <a
          href="https://en.wikipedia.org/wiki/Languages_of_Ukraine">Wikipedia</a>).</p>
      <p>In both cases, the clustering coefficient for the random network is actually higher than that of the original
        graphs, which tells us something about users replying to a tweet, will not usually continue to the talk with
        each other in the replies section for instance. Especially when retweeting is such a big part of twitter - if
        many people retweet the same tweet, they of course have the same parent author, but a cluster will not form
        around them since they do not reply to eachother. We can relate this to how the orignal networks compare to
        their random counterpart visually - in both networks, the number of edges are the roughly the same in the
        original and random networks, but the number of nodes is higher in the random graph. This could explain why the
        original networks look more sparse than their random counterpart.</p>
      <p>This clustering trend makes sense if we consider how useres generally interact on Twitter. The structure we
        typically will see in Twitter networks is for instance a certain tweet will go viral, which many will retweet,
        reply to and quote tweet - then these replies and quote tweeets will be retweeted and replied to and so on and
        it will continue almost in an exponential manner, meaning that people will not form one big discussion forum in
        the comments of the original tweet, but rather spread the message in a very fast and "broad" way.
        Furthermore, the connections we observe in these networks are not the same connections we see in a social
        network for instance - the links do not correspond to friendships but rather a reaction a user might have on
        something another user stated. Parent authors will not be enclined to respond in the same way as on Reddit for
        instance - if the Twitter account of big television network posts a tweet about some current news regarding the
        War, they will most likely not responds to users in their comment section. This means we will not typically
        observe triadic closures in these Twitter networks compared to a social network of friends, family and
        co-workers.</p>
      <p>Comparing the trend of how people interact on Twitter with Reddit, we know that there is much more of a sense
        of community on Reddit - when people will interact in subreddits talking about a specific topic and from
        answering each other back and fourth, they are much more likely to become friends or acquaintances at least. On
        Twitter however, seeing as the we investigate a difficult and widespread topic, there is not the same sense of
        community as on Reddit.</p>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h4 id="Investigating-Communities-in-the-Twitter-Networks">Investigating Communities in the Twitter Networks<a
          class="anchor-link" href="#Investigating-Communities-in-the-Twitter-Networks">&#182;</a></h4>
      <p>Even though we do not see the same strong sense of community on Twitter compared to Reddit, we can still
        investigate interesting properties of the unique community structures (if there exists such structures).</p>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h5 id="Modularity">Modularity<a class="anchor-link" href="#Modularity">&#182;</a></h5>
      <p>We can investigate the communities in the Twitter networks by computing the modularity values, which helps us
        measure how well a certain partition is at detecting communities. The higher these values are, the stronger are
        the created communities. This is because the <em>observed</em> number of links between nodes in the community is
        higher than the <em>expected</em> number of links, and we can infer that a certain cluster structure must be
        present.</p>
      <p>The modularity is a number between $[-1,1]$ - a value close to 1 indicates a strong partitioning and if we
        assign the whole network to a single community, the modularity value becomes 0 and a negative modularity value
        occurs for instance when we assign each node to a their own individual community.</p>
      <p>Computing the modularity of several partition allows us to compare them with eachother and optimizing this
        modularity value helps us to detect even stronger communities.</p>
      <p>Based on equation 9.12 in <a href="http://networksciencebook.com/chapter/9#modularity">section 9.4 of the
          Network Science book</a>, the formula for modularity is:
        $$
        M=\sum_{c=1}^{n_{c}}\left[\frac{L_{c}}{L}-\left(\frac{k_{c}}{2 L}\right)^{2}\right]
        $$</p>
      <p>where $n_c$ is the number of communities in the partition, $N_c$ and $L_c$ is the number of nodes and edges
        respectively in each of the $n_c$ communities. Furthermore, $k_c$ is the total degree of nodes in in a community
        $C_c$ and L is the number of links in the entire graph. We formulate this in the following function:</p>

    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="k">def</span> <span class="nf">compute_modularity</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">partition</span><span class="p">):</span>
   
    <span class="n">communities</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">partition</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>  
    <span class="n">L</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">number_of_edges</span><span class="p">()</span>
    
    <span class="n">M</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">communities</span><span class="p">:</span>
        <span class="n">group_c</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">partition</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="n">c</span><span class="p">]</span>
        <span class="n">subgraph_c</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">group_c</span><span class="p">)</span>
        <span class="n">k_c</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">graph</span><span class="o">.</span><span class="n">degree</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">subgraph_c</span><span class="o">.</span><span class="n">nodes</span><span class="p">()])</span>
        <span class="n">L_c</span> <span class="o">=</span> <span class="n">subgraph_c</span><span class="o">.</span><span class="n">number_of_edges</span><span class="p">()</span>
        <span class="n">M</span> <span class="o">+=</span> <span class="p">(</span><span class="n">L_c</span><span class="o">/</span><span class="n">L</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">k_c</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">L</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
        
    <span class="k">return</span> <span class="n">M</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h5 id="Community-Partitions">Community Partitions<a class="anchor-link" href="#Community-Partitions">&#182;</a>
      </h5>
      <p>To find communities in the Twitter Networks, we use <a href="https://anaconda.org/auto/python-louvain">the
          Python Louvain-algorithm implementation</a> and we can use these partitions to color the nodes of the networks
        accordingly.</p>

    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">partition_uk</span> <span class="o">=</span> <span class="n">community</span><span class="o">.</span><span class="n">community_louvain</span><span class="o">.</span><span class="n">best_partition</span><span class="p">(</span><span class="n">H_uk</span><span class="p">)</span>
<span class="n">partition_ru</span> <span class="o">=</span> <span class="n">community</span><span class="o">.</span><span class="n">community_louvain</span><span class="o">.</span><span class="n">best_partition</span><span class="p">(</span><span class="n">H_ru</span><span class="p">)</span>

<span class="n">H_uk_mod</span> <span class="o">=</span> <span class="n">compute_modularity</span><span class="p">(</span><span class="n">H_uk</span><span class="p">,</span> <span class="n">partition_uk</span><span class="p">)</span>
<span class="n">H_ru_mod</span> <span class="o">=</span> <span class="n">compute_modularity</span><span class="p">(</span><span class="n">H_ru</span><span class="p">,</span> <span class="n">partition_ru</span><span class="p">)</span>

<span class="c1"># to visualize the communities</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">H_uk</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">v</span><span class="p">[</span><span class="s1">&#39;group&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">partition_uk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
    

<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">H_ru</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">v</span><span class="p">[</span><span class="s1">&#39;group&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">partition_ru</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p>Modularity value for Ukrainian Twitter Graph: <strong>0.92265</strong></p>
      <p>Modularity value for Russian Twitter Graph: <strong>0.88728</strong></p>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p><strong>Visualizing the communities in the Ukrainian network:</strong>
        <img src="assets/imgs/network graphs/H_uk_comms.png" style="width:600px"></p>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p><strong>Visualizing the communities in the Russian network:</strong>
        <img src="assets/imgs/network graphs/H_ru_comms.png" style="width:600px"></p>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h4 id="Statistical-Evaluation-of-the-Modularities">Statistical Evaluation of the Modularities<a
          class="anchor-link" href="#Statistical-Evaluation-of-the-Modularities">&#182;</a></h4>
      <p>Before we can conclude anything regarding the found communities based on their modularity value, we must asses
        if the modularity computed is statitically different from $0$. To do this we implement a configuration model,
        which will create a new network, such that the degree of each node is the same as in the original network, but
        with different links. The algorithm works in the following way:</p>
      <ul>
        <li>Create an identical copy of the original network.</li>
        <li>Consider the list of network edges and split them into source and target nodes.</li>
        <li>Concencatenate the two lists into a unique list (a list of stubs).</li>
        <li>Shuffle the list and build a new set of edges.</li>
        <li>Remove all the orignal edges and add the new shuffled edges to the network.</li>
      </ul>
      <p>This is implemented in the following function:</p>

    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="k">def</span> <span class="nf">config_model</span><span class="p">(</span><span class="n">G</span><span class="p">):</span>
    
    <span class="c1"># unpack the tuples in the edge list:</span>
    <span class="n">unique_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">t</span><span class="p">]</span>

    <span class="c1"># shuffle stubs:</span>
    <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">unique_list</span><span class="p">)</span>

    <span class="c1"># new set of edges:</span>
    <span class="n">new_edges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="n">unique_list</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_list</span><span class="p">),</span> <span class="mi">2</span><span class="p">)],</span>
                         <span class="p">[</span><span class="n">unique_list</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_list</span><span class="p">),</span> <span class="mi">2</span><span class="p">)]))</span>

    <span class="c1"># initialize new graph with created graphs</span>
    <span class="n">G_new</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">MultiGraph</span><span class="p">()</span>
    <span class="n">G_new</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">new_edges</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">G_new</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p>Using this algorithm we create $1000$ randomized version of the networks and for each of them, we compute the
        modularity of the partitions.</p>

    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="k">def</span> <span class="nf">config_mod1000</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">partition</span><span class="p">):</span>
    <span class="n">swaps</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>

        <span class="n">T</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">T_swap</span> <span class="o">=</span> <span class="n">config_model</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
        <span class="n">swaps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">T_swap</span><span class="p">)</span>
    
    <span class="n">modularities</span> <span class="o">=</span> <span class="p">[</span><span class="n">compute_modularity</span><span class="p">(</span><span class="n">swap</span><span class="p">,</span> <span class="n">partition</span><span class="p">)</span> <span class="k">for</span> <span class="n">swap</span> <span class="ow">in</span> <span class="n">swaps</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">modularities</span>
    
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">uk_mods</span> <span class="o">=</span> <span class="n">config_mod1000</span><span class="p">(</span><span class="n">H_uk</span><span class="p">,</span> <span class="n">partition_uk</span><span class="p">)</span>
<span class="n">ru_mods</span> <span class="o">=</span> <span class="n">config_mod1000</span><span class="p">(</span><span class="n">H_ru</span><span class="p">,</span> <span class="n">partition_ru</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p>We can plot these modularities for each network:</p>

    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># set up plotting parameters</span>
<span class="k">def</span> <span class="nf">setup_mpl</span><span class="p">():</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;font.family&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Helvetica Neue&quot;</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;lines.linewidth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">setup_mpl</span><span class="p">()</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">tight_layout</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">uk_mods</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Random modularity&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

    
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">H_uk_mod</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Original modularity&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Modularity&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Ukraine: Original vs Random Modularity&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;uk_1000mods.png&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">tight_layout</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ru_mods</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Random modularity&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

    
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">H_uk_mod</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Original modularity&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Modularity&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Russia: Original vs Random Modularity&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;ru_1000mods.png&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p><img src="assets/imgs/network graphs/uk_1000mods.png" style="width:800px">
        <img src="assets/imgs/network graphs/ru_1000mods.png" style="width:800px"></p>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p>The 95th percentile for both tests are:</p>
      <ul>
        <li>Ukrainian: <strong>0.0042178</strong></li>
        <li>Russian: <strong>0.09992178</strong></li>
      </ul>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h5 id="Community-stats">Community stats<a class="anchor-link" href="#Community-stats">&#182;</a></h5>
      <p><strong>Ukraine:</strong></p>
      <ul>
        <li>606 communities in total</li>
        <li>Size of top 5 communities: [(14, 164), (26, 136), (3, 100), (10, 85), (30, 75)] </li>
      </ul>
      <p><strong>Russia:</strong></p>
      <ul>
        <li>1323 communities in total</li>
        <li>Size of top 5 communities: [(120, 291), (28, 290), (4, 228), (6, 225), (24, 194)]</li>
      </ul>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p>In both cases the modularities of the configuration models are centered around zero, which correspond to
        assigning the network to a single community - meaning there are not communities present. Visualizing the
        modularities and computing the 95th percentile of the modularities allows to clearly conclude that the
        modularity values of 0.923 and 0.887 for the Ukrainian and Russian network respectively are significantly
        different from 0. This means that the partitions found by the Python Louvain algorithm are better than assigning
        no communities at all or assigning each node to its own community.</p>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p>In investigating some of these communities, we see for instance in the Ukrainian network that the following
        three users have the highest in-degrees:</p>
      <ul>
        <li><strong>"ng_ukraine</strong>: A Ukraine government organization</li>
        <li><strong>"mil_in_ua"</strong>: An account posting news about the war with the bio <em>"Honest about the army,
            war and defense since 2009"</em></li>
        <li><strong>"USEmbassyKyiv"</strong>: The Twitter account for embassy of the United States of America in Kyiv.
        </li>
      </ul>
      <p>Authors with the highest in-degrees in the Russian network:</p>
      <ul>
        <li><strong>"dw_russian"</strong>: Twitter account for the German broadcaster channel Deutsche Welle reporthing
          about Russia and Europe.</li>
        <li><strong>"RT_russian"</strong>: This account is actually restricted in response to a legal demand (as of
          4/5/22)</li>
        <li><strong>"i_army_org"</strong>: A twitter account posting about the war</li>
      </ul>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p>When looking at these the visualizations, coloring the nodes based on the community partitions allows us to
        detect some cluster structures. Some of the bigger cluster structures are results from the neighborhood between
        the mentioned parent authors above and the users reacting to their tweets. As perhaps expected, most of the
        clusters come from users retweeting and replying to bigger news stations or organizations in both networks. We
        do not typically see <em>private</em> people engage in discussion of the same size as for the news stations, but
        as discussed earlier, this is likely becuase of the nature that is tweeting and replying to each other that
        differs from that trend we see on Reddit.</p>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h4 id="Interactive-Ukrainian-and-Russian-Twitter-Networks">Interactive Ukrainian and Russian Twitter Networks<a
          class="anchor-link" href="#Interactive-Ukrainian-and-Russian-Twitter-Networks">&#182;</a></h4>
      <p>For visualization purposes, we also create interactive versions of the Ukrainian and Russian networks, where
        the reader is able to investigate the communities and read what they are tweeting about. Due to computaional
        limitations, these networks will be a subset of the original two Twitter networks.</p>

    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">subset_tweets</span> <span class="o">=</span> <span class="n">all_tweets</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span>

<span class="n">w_edgelist_ru</span> <span class="o">=</span> <span class="n">create_w_edgelist</span><span class="p">(</span><span class="n">subset_tweets</span><span class="p">,</span> <span class="s2">&quot;ru&quot;</span><span class="p">)</span>
<span class="n">_</span><span class="p">,</span> <span class="n">I_ru</span> <span class="o">=</span> <span class="n">create_nx_graph</span><span class="p">(</span><span class="s2">&quot;ru&quot;</span><span class="p">,</span><span class="n">w_edgelist_ru</span><span class="p">)</span>

<span class="n">w_edgelist_uk</span> <span class="o">=</span> <span class="n">create_w_edgelist</span><span class="p">(</span><span class="n">subset_tweets</span><span class="p">,</span> <span class="s2">&quot;uk&quot;</span><span class="p">)</span>
<span class="n">_</span><span class="p">,</span> <span class="n">I_uk</span> <span class="o">=</span> <span class="n">create_nx_graph</span><span class="p">(</span><span class="s2">&quot;uk&quot;</span><span class="p">,</span><span class="n">w_edgelist_uk</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p><strong>Ukrainian Interactive Network</strong></p>
      <ul>
        <li>Number of nodes: 583</li>
        <li>Number of edges: 374</li>
        <li>Average degree: 1.2830</li>
      </ul>
      <p><strong>Russian Interactive Network</strong></p>
      <ul>
        <li>Number of nodes: 1557</li>
        <li>Number of edges: 1030</li>
        <li>Average degree: 1.3231 </li>
      </ul>

    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">partition_I_ru</span> <span class="o">=</span> <span class="n">community</span><span class="o">.</span><span class="n">community_louvain</span><span class="o">.</span><span class="n">best_partition</span><span class="p">(</span><span class="n">I_ru</span><span class="p">)</span>
<span class="n">partition_I_uk</span> <span class="o">=</span> <span class="n">community</span><span class="o">.</span><span class="n">community_louvain</span><span class="o">.</span><span class="n">best_partition</span><span class="p">(</span><span class="n">I_uk</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># get text between a user and its parent author</span>
<span class="k">def</span> <span class="nf">get_text</span><span class="p">(</span><span class="n">username</span><span class="p">,</span><span class="n">parent</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">subset_tweets</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">subset_tweets</span><span class="p">[</span><span class="s2">&quot;username&quot;</span><span class="p">]</span><span class="o">==</span><span class="n">username</span><span class="p">)</span><span class="o">&amp;</span>
                         <span class="p">(</span><span class="n">subset_tweets</span><span class="p">[</span><span class="s2">&quot;parent_author&quot;</span><span class="p">]</span><span class="o">==</span><span class="n">parent</span><span class="p">)]</span><span class="o">.</span><span class="n">translated_text</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># weighted edgelist as a dataframe with texts</span>

<span class="k">def</span> <span class="nf">w_edgelist_df</span><span class="p">(</span><span class="n">language</span><span class="p">,</span> <span class="n">w_edgelist</span><span class="p">):</span>
    <span class="n">w_edgelist_df</span> <span class="o">=</span> <span class="n">w_edgelist</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="s1">&#39;size&#39;</span><span class="p">)</span>
    <span class="n">w_edgelist_df</span> <span class="o">=</span> <span class="n">w_edgelist_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span> 
    <span class="n">w_edgelist_df</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">w_edgelist_df</span><span class="p">[[</span><span class="s1">&#39;username&#39;</span><span class="p">,</span><span class="s1">&#39;parent_author&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">get_text</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">w_edgelist_df</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">w_edgelist_df_ru</span> <span class="o">=</span> <span class="n">w_edgelist_df</span><span class="p">(</span><span class="s2">&quot;ru&quot;</span><span class="p">,</span><span class="n">w_edgelist_ru</span><span class="p">)</span>
<span class="n">w_edgelist_df_uk</span> <span class="o">=</span> <span class="n">w_edgelist_df</span><span class="p">(</span><span class="s2">&quot;uk&quot;</span><span class="p">,</span><span class="n">w_edgelist_uk</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p>We create the interactive graphs using the Pyvis library. Note that parent authors will not have a tweet
        attached to them, since they can have multiple tweets.</p>

    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="k">def</span> <span class="nf">create_interactive_graph</span><span class="p">(</span><span class="n">w_edgelist</span><span class="p">,</span> <span class="n">w_edgelist_df</span><span class="p">,</span> <span class="n">partition</span><span class="p">):</span>
    <span class="c1">#</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#</span><span class="si">{:06x}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mh">0xFFFFFF</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">partition</span><span class="o">.</span><span class="n">values</span><span class="p">())))]</span>
    <span class="n">net</span> <span class="o">=</span> <span class="n">Network</span><span class="p">(</span><span class="n">notebook</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">net</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="s1">&#39;1000px&#39;</span>
    <span class="n">net</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s1">&#39;1000px&#39;</span>

    <span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">w_edgelist_df</span><span class="o">.</span><span class="n">username</span><span class="o">.</span><span class="n">unique</span><span class="p">()):</span>
        <span class="n">net</span><span class="o">.</span><span class="n">add_nodes</span><span class="p">([</span><span class="n">user</span><span class="p">],</span>
                         <span class="n">title</span><span class="o">=</span><span class="p">[</span><span class="n">w_edgelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">w_edgelist_df</span><span class="p">[</span><span class="s2">&quot;username&quot;</span><span class="p">]</span><span class="o">==</span><span class="n">user</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                        <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="n">colors</span><span class="p">[</span><span class="n">partition</span><span class="p">[</span><span class="n">user</span><span class="p">]]</span> <span class="k">if</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">partition</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;#FFFFFF&#39;</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">parent</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">w_edgelist_df</span><span class="o">.</span><span class="n">parent_author</span><span class="o">.</span><span class="n">unique</span><span class="p">()):</span>
        <span class="n">net</span><span class="o">.</span><span class="n">add_nodes</span><span class="p">([</span><span class="n">parent</span><span class="p">],</span>
                        <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="n">colors</span><span class="p">[</span><span class="n">partition</span><span class="p">[</span><span class="n">parent</span><span class="p">]]</span> <span class="k">if</span> <span class="n">parent</span> <span class="ow">in</span> <span class="n">partition</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;#FFFFFF&#39;</span><span class="p">])</span>

    <span class="c1"># when adding users as nodes in the pyvis network, some of the user-strings are altered, </span>
    <span class="c1"># so we use a try/except statement (only a few nodes are missed)</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">w_edgelist</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">net</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">value</span><span class="p">)])</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">continue</span>
    <span class="k">return</span> <span class="n">net</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">net_uk</span> <span class="o">=</span> <span class="n">create_interactive_graph</span><span class="p">(</span><span class="n">w_edgelist_uk</span><span class="p">,</span> <span class="n">w_edgelist_df_uk</span><span class="p">,</span> <span class="n">partition_uk</span><span class="p">)</span>
<span class="n">net_uk</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s1">&#39;uk_final.html&#39;</span><span class="p">)</span>

<span class="n">net_ru</span> <span class="o">=</span> <span class="n">create_interactive_graph</span><span class="p">(</span><span class="n">w_edgelist_ru</span><span class="p">,</span> <span class="n">w_edgelist_df_ru</span><span class="p">,</span> <span class="n">partition_ru</span><span class="p">)</span>
<span class="n">net_ru</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s1">&#39;ru_final.html&#39;</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <p>The interactive networks can be found on our website!</p>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h2 id="Discussion.-What-worked-and-what-didn't.-And-why.">Discussion. What worked and what didn't. And why.<a
          class="anchor-link" href="#Discussion.-What-worked-and-what-didn't.-And-why.">&#182;</a></h2>
    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h4 id="Reduction-and-incompleteness-of-the-dataset">Reduction and incompleteness of the dataset<a
          class="anchor-link" href="#Reduction-and-incompleteness-of-the-dataset">&#182;</a></h4>
      <p>One of the most important limitations to address in this project is the size and "incompletenes" of our
        dataset. The original dataset consisted of more than 3 million data points which is an extensively large amount
        of data. However, it will still lack some tweets addressing the Russia-Ukraine war, if they do not contain the
        specified key words in the data collection query. Moreover we reduced the dataset further, when we subsampled
        18.000 tweets per day due to computational limits, yielding an even bigger loss of tweets discussing the
        subject. We intended to use our final dataset of 1 million tweets for all analysis purposes. However, in
        practice this became infeasible due to time and computational limits, and therefore we ended up using an even
        smaller part of the dataset for some parts of our analysis. This reduction of our dataset is important to keep
        in mind when making any conclusions on the basis of this data, as it can only serve as a representative of the
        true trends and conclusions. However, we argue that the data partitions used for all parts of the analysis is
        still a representative cross section of the complete debate on Twitter and the trends associated with it, as we
        subsampled our data uniformly across all dates and randomly within each day.</p>
      <h4 id="Lack-of-location-data">Lack of location data<a class="anchor-link"
          href="#Lack-of-location-data">&#182;</a></h4>
      <p>At first hand our plan was to use the (geo-)location data associated with each tweet to seperate networks and
        parts of the text analyses on nationality. Anyhow, during the time of the project work we realised that most
        Twitter users do not allow tracking of geo-location and the location data provided by the users themselves were
        filled with bugs and unusable information. As a workaround we therefore used the written language of the tweet
        instead. This can still give some indications of trends within nationalities although the analyses was now
        limited to the tweets written by people who expressed themselves in their mother language. Moreover, the English
        written language is used by the majority of users across all nationalities which makes the distribution of
        tweets for each language significantly skewed. Still we found it interesting to investigate the trends within
        Ukrainian and Russian as well as the general public using English, and we concluded that it was still somehow
        representative of the subsequent nationalities because of the great amount of data.</p>
      <h4 id="Skewed-distribution-of-tweet">Skewed distribution of tweet<a class="anchor-link"
          href="#Skewed-distribution-of-tweet">&#182;</a></h4>
      <p>Looking at the tweet volume volatility for the languages English, Russian and Ukranian, we found that there
        were significantly more English tweets compared to the others. This is important to be aware of when we conclude
        anything within the time domain, as the English written tweets will dominate the tendencies significantly. In
        other words when drawing any conclusions about the overall tendencies based on time, it will be much more
        representative for the English speaking "community" on Twitter than any other. However, as this also indicates
        that the majority of Twitter users communicate on English, we can argue that the time analysis and conclusions
        are still representative of the majority of Twitter users i.e. the overall public opinions and trends. This bias
        is removed in the language analysis, as we filter the tweets on language and only consider tweets within one
        written language at a time.</p>
      <h4 id="No-significant-results-in-dispersion-plot">No significant results in dispersion plot<a class="anchor-link"
          href="#No-significant-results-in-dispersion-plot">&#182;</a></h4>
      <p>Our initial intention with the dispersion plot was to show some kind of development in the usage of certain
        words over time. However, as we had to specify the words displayed in the plot manually, the process became
        somewhat trial-and-error based. We expected that using the most frequently used/general key words in the debate
        would not give any significant results, as these words are used continously in time. Therefore we experimented
        with more specific words representing certain events such as "nuclear war" and "chernobyl" and expected to see a
        higher usage of these words around the period in time, where the events took place. Still, this was not the case
        in practice and therefore the dispersion plot was rather uninformative in the end.</p>
      <h4 id="Keywords-introduce-bias">Keywords introduce bias<a class="anchor-link"
          href="#Keywords-introduce-bias">&#182;</a></h4>
      <p>One rather important bias in our analysis and dataset is the use of keywords in the data collection. As the
        tweets were queried based on these specific key words, the volume of tweets containing these words will also
        unnaturally high. This is an important flaw in our analysis when investigating any kind of trends based on
        frequency, as many of the key words will logically appear as very popular. Examples of analysis where this bias
        is significant are the bar chart of most popular hashtags or the word shift plots. A work-around could have been
        to remove all key words from our dataset but this might have resulted in other important tendencies getting lost
        instead.</p>

    </div>
  </div>
  <div class="jp-Cell-inputWrapper">
    <div class="jp-InputPrompt jp-InputArea-prompt">
    </div>
    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
      <h4 id="Building-the-Twitter-networks">Building the Twitter networks<a class="anchor-link"
          href="#Building-the-Twitter-networks">&#182;</a></h4>
      <p>As mentioned when building the Twitter Networks, one limitation of our data set is that the tweets we fetch
        must contain the keywords "russia, ukraine, putin, zelensky" etc. - this means we are not able to follow an
        entire Twitter thread if the replies to the original tweet does not contain any of these keywords. For our
        networks this limitation means we will almost never see triadic closures between the parent author and the users
        who reply to their tweet. Even if we wanted to fecth all replies like we did with the "search_comments" function
        from the Reddit API, we would need access to a Premium Account on Twiiter API. However, we argue that even if we
        had all replies, the nature of how twitter users behave is still represented in our networks - users do not
        often gather in the same thread and stay for long enough to reply to each other, but rather scatter throughout
        the conversation, almost in an exponential manner as mentioned earlier.</p>
      <p>Furthermore, one could expand these networks so they are not based on the interaction between users and parent
        authors of a particular language, but rather on how users gather in groups discussing certain topics that might
        arise in this difficult subject matter. This would require a form of NLP-based sentiment analysis on top of the
        network analysis, which could prove itself to be difficult to carry out, but also very interesting to
        investigate.</p>

    </div>
  </div>



  <!-- end add mathjax code here -->



</body>

</html>